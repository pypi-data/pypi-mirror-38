{"version":3,"sources":["webpack://swh.[name]/webpack/universalModuleDefinition","webpack://swh.[name]/webpack/bootstrap","webpack://swh.[name]/./node_modules/@babel/runtime-corejs2/core-js/json/stringify.js","webpack://swh.[name]/./node_modules/core-js/library/fn/json/stringify.js","webpack://swh.[name]/./node_modules/core-js/library/modules/_core.js","webpack://swh.[name]/./swh/web/assets/src/bundles/admin/deposit.js","webpack://swh.[name]/./swh/web/assets/src/bundles/admin/index.js","webpack://swh.[name]/./swh/web/assets/src/bundles/admin/origin-save.js","webpack://swh.[name]/./swh/web/assets/src/utils/functions.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;AClFA,iBAAiB,mBAAO,CAAC,8FAAmC,E;;;;;;;;;;;ACA5D,WAAW,mBAAO,CAAC,4EAAqB;AACxC,uCAAuC,4BAA4B;AACnE,yCAAyC;AACzC;AACA;;;;;;;;;;;;ACJA,6BAA6B;AAC7B,uCAAuC;;;;;;;;;;;;;ACDvC;AAAA;AAAA;AAAA;AAA4E;AACrE;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,oFAAe;AACpC;;AAEA,8CAA8C,kBAAkB,kBAAkB;AAClF;;AAEA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH,C;;;;;;;;;;;;AC5EA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAC0B;;;;;;;;;;;;;ACN1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAC6D;AAC7D;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;AACH;AACO;AACP;AACA;AACA,EAAE,gEAAQ,oBAAoB,gEAAgB;AAC9C;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH;AACO;AACP;;AAEA;AACA;AACA,IAAI,gEAAQ,uBAAuB,gEAAgB;AACnD;AACA,KAAK,sBAAsB;AAC3B;AACA;AACO;AACP;AACA;AACA,EAAE,gEAAQ,oBAAoB,gEAAgB;AAC9C;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH;AACO;AACP;;AAEA;AACA;AACA,IAAI,gEAAQ,uBAAuB,gEAAgB;AACnD;AACA,KAAK,sBAAsB;AAC3B;AACA;AACO;AACP;;AAEA;AACA;AACA;AACA;AACA,MAAM,gEAAQ;AACd;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACO;AACP;;AAEA;AACA;AACA;AACA;AACA,MAAM,gEAAQ;AACd;AACA,OAAO;AACP;;AAEA;AACA;AACA,C;;;;;;;;;;;;ACvNA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;;AAEA;AACA;AACO;AACP,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACO;AACP,cAAc,UAAU;AACxB;AACO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACO;AACP;AACA;AACA;AACA;AACA;AACA,C","file":"js/admin.88ec4175b9c14118ec0d.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"admin\"] = factory();\n\telse\n\t\troot[\"swh\"] = root[\"swh\"] || {}, root[\"swh\"][\"admin\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","module.exports = require(\"core-js/library/fn/json/stringify\");","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n","var core = module.exports = { version: '2.5.7' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nexport function initDepositAdmin() {\n  var depositsTable;\n  $(document).ready(function () {\n    $.fn.dataTable.ext.errMode = 'none';\n    depositsTable = $('#swh-admin-deposit-list').on('error.dt', function (e, settings, techNote, message) {\n      $('#swh-admin-deposit-list-error').text(message);\n    }).DataTable({\n      serverSide: true,\n      ajax: Urls.admin_deposit_list(),\n      columns: [{\n        data: 'id',\n        name: 'id'\n      }, {\n        data: 'external_id',\n        name: 'external_id',\n        render: function render(data, type, row) {\n          if (type === 'display') {\n            if (data && data.startsWith('hal')) {\n              return \"<a href=\\\"https://hal.archives-ouvertes.fr/\" + data + \"\\\">\" + data + \"</a>\";\n            }\n          }\n\n          return data;\n        }\n      }, {\n        data: 'reception_date',\n        name: 'reception_date',\n        render: function render(data, type, row) {\n          if (type === 'display') {\n            var date = new Date(data);\n            return date.toLocaleString();\n          }\n\n          return data;\n        }\n      }, {\n        data: 'status',\n        name: 'status'\n      }, {\n        data: 'status_detail',\n        name: 'status_detail',\n        render: function render(data, type, row) {\n          if (type === 'display' && data) {\n            var text = data;\n\n            if (typeof data === 'object') {\n              text = _JSON$stringify(data, null, 4);\n            }\n\n            return \"<div style=\\\"width: 200px; white-space: pre; overflow-x: auto;\\\">\" + text + \"</div>\";\n          }\n\n          return data;\n        },\n        orderable: false\n      }, {\n        data: 'swh_id',\n        name: 'swh_id',\n        render: function render(data, type, row) {\n          if (type === 'display') {\n            if (data && data.startsWith('swh')) {\n              var browseUrl = Urls.browse_swh_id(data);\n              return \"<a href=\\\"\" + browseUrl + \"\\\">\" + data + \"</a>\";\n            }\n          }\n\n          return data;\n        }\n      }],\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']]\n    });\n    depositsTable.draw();\n  });\n}","/**\n * Copyright (C) 2018  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\nexport * from './deposit';\nexport * from './origin-save';","/**\n * Copyright (C) 2018  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\nimport { handleFetchError, csrfPost } from 'utils/functions';\nvar authorizedOriginTable;\nvar unauthorizedOriginTable;\nvar pendingSaveRequestsTable;\nvar acceptedSaveRequestsTable;\nvar rejectedSaveRequestsTable;\n\nfunction enableRowSelection(tableSel) {\n  $(tableSel + \" tbody\").on('click', 'tr', function () {\n    if ($(this).hasClass('selected')) {\n      $(this).removeClass('selected');\n    } else {\n      $(tableSel + \" tr.selected\").removeClass('selected');\n      $(this).addClass('selected');\n    }\n  });\n}\n\nexport function initOriginSaveAdmin() {\n  $(document).ready(function () {\n    authorizedOriginTable = $('#swh-authorized-origin-urls').DataTable({\n      serverSide: true,\n      ajax: Urls.admin_origin_save_authorized_urls_list(),\n      columns: [{\n        data: 'url',\n        name: 'url'\n      }],\n      scrollY: '50vh',\n      scrollCollapse: true,\n      info: false\n    });\n    enableRowSelection('#swh-authorized-origin-urls');\n    unauthorizedOriginTable = $('#swh-unauthorized-origin-urls').DataTable({\n      serverSide: true,\n      ajax: Urls.admin_origin_save_unauthorized_urls_list(),\n      columns: [{\n        data: 'url',\n        name: 'url'\n      }],\n      scrollY: '50vh',\n      scrollCollapse: true,\n      info: false\n    });\n    enableRowSelection('#swh-unauthorized-origin-urls');\n    var columnsData = [{\n      data: 'save_request_date',\n      name: 'request_date',\n      render: function render(data, type, row) {\n        if (type === 'display') {\n          var date = new Date(data);\n          return date.toLocaleString();\n        }\n\n        return data;\n      }\n    }, {\n      data: 'origin_type',\n      name: 'origin_type'\n    }, {\n      data: 'origin_url',\n      name: 'origin_url',\n      render: function render(data, type, row) {\n        if (type === 'display') {\n          return \"<a href=\\\"\" + data + \"\\\">\" + data + \"</a>\";\n        }\n\n        return data;\n      }\n    }];\n    pendingSaveRequestsTable = $('#swh-origin-save-pending-requests').DataTable({\n      serverSide: true,\n      ajax: Urls.browse_origin_save_requests_list('pending'),\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']]\n    });\n    enableRowSelection('#swh-origin-save-pending-requests');\n    rejectedSaveRequestsTable = $('#swh-origin-save-rejected-requests').DataTable({\n      serverSide: true,\n      ajax: Urls.browse_origin_save_requests_list('rejected'),\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']]\n    });\n    columnsData.push({\n      data: 'save_task_status',\n      name: 'save_task_status',\n      render: function render(data, type, row) {\n        if (data === 'succeed') {\n          var browseOriginUrl = Urls.browse_origin(row.origin_url);\n          return \"<a href=\\\"\" + browseOriginUrl + \"\\\">\" + data + \"</a>\";\n        }\n\n        return data;\n      }\n    });\n    acceptedSaveRequestsTable = $('#swh-origin-save-accepted-requests').DataTable({\n      serverSide: true,\n      ajax: Urls.browse_origin_save_requests_list('accepted'),\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']]\n    });\n    $('#swh-origin-save-requests-nav-item').on('shown.bs.tab', function () {\n      pendingSaveRequestsTable.draw();\n    });\n    $('#swh-origin-save-url-filters-nav-item').on('shown.bs.tab', function () {\n      authorizedOriginTable.draw();\n    });\n    $('#swh-authorized-origins-tab').on('shown.bs.tab', function () {\n      authorizedOriginTable.draw();\n    });\n    $('#swh-unauthorized-origins-tab').on('shown.bs.tab', function () {\n      unauthorizedOriginTable.draw();\n    });\n    $('#swh-save-requests-pending-tab').on('shown.bs.tab', function () {\n      pendingSaveRequestsTable.draw();\n    });\n    $('#swh-save-requests-accepted-tab').on('shown.bs.tab', function () {\n      acceptedSaveRequestsTable.draw();\n    });\n    $('#swh-save-requests-rejected-tab').on('shown.bs.tab', function () {\n      rejectedSaveRequestsTable.draw();\n    });\n    $('#swh-save-requests-pending-tab').click(function () {\n      pendingSaveRequestsTable.ajax.reload(null, false);\n    });\n    $('#swh-save-requests-accepted-tab').click(function () {\n      acceptedSaveRequestsTable.ajax.reload(null, false);\n    });\n    $('#swh-save-requests-rejected-tab').click(function () {\n      rejectedSaveRequestsTable.ajax.reload(null, false);\n    });\n  });\n}\nexport function addAuthorizedOriginUrl() {\n  var originUrl = $('#swh-authorized-url-prefix').val();\n  var addOriginUrl = Urls.admin_origin_save_add_authorized_url(originUrl);\n  csrfPost(addOriginUrl).then(handleFetchError).then(function () {\n    authorizedOriginTable.row.add({\n      'url': originUrl\n    }).draw();\n  }).catch(function (response) {\n    swh.webapp.showModalMessage('Duplicated origin url prefix', 'The provided origin url prefix is already registered in the authorized list.');\n  });\n}\nexport function removeAuthorizedOriginUrl() {\n  var originUrl = $('#swh-authorized-origin-urls tr.selected').text();\n\n  if (originUrl) {\n    var removeOriginUrl = Urls.admin_origin_save_remove_authorized_url(originUrl);\n    csrfPost(removeOriginUrl).then(handleFetchError).then(function () {\n      authorizedOriginTable.row('.selected').remove().draw();\n    }).catch(function () {});\n  }\n}\nexport function addUnauthorizedOriginUrl() {\n  var originUrl = $('#swh-unauthorized-url-prefix').val();\n  var addOriginUrl = Urls.admin_origin_save_add_unauthorized_url(originUrl);\n  csrfPost(addOriginUrl).then(handleFetchError).then(function () {\n    unauthorizedOriginTable.row.add({\n      'url': originUrl\n    }).draw();\n  }).catch(function () {\n    swh.webapp.showModalMessage('Duplicated origin url prefix', 'The provided origin url prefix is already registered in the unauthorized list.');\n  });\n}\nexport function removeUnauthorizedOriginUrl() {\n  var originUrl = $('#swh-unauthorized-origin-urls tr.selected').text();\n\n  if (originUrl) {\n    var removeOriginUrl = Urls.admin_origin_save_remove_unauthorized_url(originUrl);\n    csrfPost(removeOriginUrl).then(handleFetchError).then(function () {\n      unauthorizedOriginTable.row('.selected').remove().draw();\n    }).catch(function () {});\n  }\n}\nexport function acceptOriginSaveRequest() {\n  var selectedRow = pendingSaveRequestsTable.row('.selected');\n\n  if (selectedRow.length) {\n    var acceptOriginSaveRequestCallback = function acceptOriginSaveRequestCallback() {\n      var rowData = selectedRow.data();\n      var acceptSaveRequestUrl = Urls.admin_origin_save_request_accept(rowData['origin_type'], rowData['origin_url']);\n      csrfPost(acceptSaveRequestUrl).then(function () {\n        pendingSaveRequestsTable.ajax.reload(null, false);\n      });\n    };\n\n    swh.webapp.showModalConfirm('Accept origin save request ?', 'Are you sure to accept this origin save request ?', acceptOriginSaveRequestCallback);\n  }\n}\nexport function rejectOriginSaveRequest() {\n  var selectedRow = pendingSaveRequestsTable.row('.selected');\n\n  if (selectedRow.length) {\n    var rejectOriginSaveRequestCallback = function rejectOriginSaveRequestCallback() {\n      var rowData = selectedRow.data();\n      var rejectSaveRequestUrl = Urls.admin_origin_save_request_reject(rowData['origin_type'], rowData['origin_url']);\n      csrfPost(rejectSaveRequestUrl).then(function () {\n        pendingSaveRequestsTable.ajax.reload(null, false);\n      });\n    };\n\n    swh.webapp.showModalConfirm('Reject origin save request ?', 'Are you sure to reject this origin save request ?', rejectOriginSaveRequestCallback);\n  }\n}","/**\n * Copyright (C) 2018  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\n// utility functions\nexport function handleFetchError(response) {\n  if (!response.ok) {\n    throw response;\n  }\n\n  return response;\n}\nexport function handleFetchErrors(responses) {\n  for (var i = 0; i < responses.length; ++i) {\n    if (!responses[i].ok) {\n      throw responses[i];\n    }\n  }\n\n  return responses;\n}\nexport function staticAsset(asset) {\n  return \"\" + __STATIC__ + asset;\n}\nexport function csrfPost(url, headers, body) {\n  if (headers === void 0) {\n    headers = {};\n  }\n\n  if (body === void 0) {\n    body = null;\n  }\n\n  headers['X-CSRFToken'] = Cookies.get('csrftoken');\n  return fetch(url, {\n    credentials: 'include',\n    headers: headers,\n    method: 'POST',\n    body: body\n  });\n}\nexport function isGitRepoUrl(url, domain) {\n  var endOfPattern = '\\\\/[\\\\w\\\\.-]+\\\\/?(?!=.git)(?:\\\\.git(?:\\\\/?|\\\\#[\\\\w\\\\.\\\\-_]+)?)?$';\n  var pattern = \"(?:git|https?|git@)(?:\\\\:\\\\/\\\\/)?\" + domain + \"[/|:][A-Za-z0-9-]+?\" + endOfPattern;\n  var re = new RegExp(pattern);\n  return re.test(url);\n}\n;"],"sourceRoot":""}