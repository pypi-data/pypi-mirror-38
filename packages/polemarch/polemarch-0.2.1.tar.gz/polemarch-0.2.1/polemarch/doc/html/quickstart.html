
<!DOCTYPE html>
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
   <meta name="robots" content="NONE,NOARCHIVE" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
   <title>'Polemarch' documentation</title>
    <link rel="stylesheet" href="_static/vst-style.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
   <link rel="shortcut icon" href="_static/img/logo/favicon.ico" />
    <script>
        window.hostname = window.location.origin || window.location.protocol + "//" + window.location.host
    </script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/js/libs/tabSignal.js"></script>
    <script type="text/javascript" src="_static/js/common-utils.js"></script>
    <script type="text/javascript" src="_static/js/common.js"></script>
    <script type="text/javascript" src="_static/docs-sidebar.js"></script>
    <script type="text/javascript" src="_static/js/app.js"></script> 
</head>

<body class="hold-transition skin-black-light sidebar-mini">
<div id="loader-wrapper">
    <div id="loader"></div>
</div>
<div class="wrapper" >
    
    <a href="https://github.com/vstconsulting/polemarch" class="fork-me">
        <img src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
    </a>
    
    <header class="main-header">
        <!-- Logo  -->
        
    <a href="/" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixel -->
                <span class="logo-mini"><span class="bg-logo-min-doc" style="margin-left: 4px;"></span></span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg logo-span-doc"><span class="bg-logo-min-doc"></span> <span class="bg-logo-doc"></span></span>
    </a>

        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top">
            <!-- Sidebar toggle button-->
            <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
            </a>
            <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">

                </ul>
            </div>
        </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">
        <!-- sidebar: style can be found in sidebar.less -->
        <section class="sidebar">
            <!-- sidebar menu: : style can be found in sidebar.less -->
            <ul class="sidebar-menu">
                <li class="header">DOCS NAVIGATION</li>
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-from-pypi">Install from PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="#backup">Backup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update">Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-to-0-2-x">Update to 0.2.x</a></li>
<li class="toctree-l2"><a class="reference internal" href="#migrate">Migrate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-superuser">Create superuser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#change-password">Change password</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">How to participate</a></li>
<li class="toctree-l1"><a class="reference internal" href="cla.html">VST Consulting contributor agreement</a></li>
</ul>

            </ul>
            <!-- github link  -->
            
                
                <h3>Watch us on GitHub</h3>
                <p>
                <iframe src="https://ghbtns.com/github-btn.html?user=vstconsulting&repo=polemarch&type=watch&count=true&size=large&v=2"
                  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
                </p>
                
            
            <!-- quick search -->
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" class="search-input-pm"/>
      <span class="search-button-wrapper">
          <span class="fa fa-search search-button-icon"></span>
          <input type="submit" value="   " class="search-button-input" />
      </span>

      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </section>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" id='spajs-right-area'>
        <!--  Main content -->

        <!-- For notification about not up-to-date-version -->
        <div class="body" role="main"></div>
        <!-- -->

        <section class="content-header">
                <h1>'Polemarch' documentation</h1>
        </section>
        <section class="content">
            <div class="box box-info">
                <div class="box-body">
                         
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="install-from-pypi">
<h2>Install from PyPI<a class="headerlink" href="#install-from-pypi" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Install dependencies:</p>
<p>Required packages on Ubuntu/Debian:</p>
<ul class="simple">
<li>pip (<code class="docutils literal notranslate"><span class="pre">`python-pip`</span></code>)</li>
<li>virtualenv (<code class="docutils literal notranslate"><span class="pre">`python-virtualenv`</span></code>)</li>
<li>python-dev (<code class="docutils literal notranslate"><span class="pre">`python-dev`</span></code>)</li>
<li>GCC (<code class="docutils literal notranslate"><span class="pre">`gcc`</span></code>)</li>
<li>FFI library (<code class="docutils literal notranslate"><span class="pre">`libffi-dev`</span></code>)</li>
<li>Headers and development libraries for MIT Kerberos (<code class="docutils literal notranslate"><span class="pre">`libkrb5-dev`</span></code>)</li>
<li>ffi (<code class="docutils literal notranslate"><span class="pre">`libffi6`</span></code>)</li>
<li>ssl (<code class="docutils literal notranslate"><span class="pre">`libssl-dev`</span></code>)</li>
<li>YAML (<code class="docutils literal notranslate"><span class="pre">`libyaml-dev`</span></code>)</li>
<li>SASL (<code class="docutils literal notranslate"><span class="pre">`libsasl2-dev`</span></code>)</li>
<li>LDAP (<code class="docutils literal notranslate"><span class="pre">`libldap2-dev`</span></code>)</li>
<li>python 2.7 (<code class="docutils literal notranslate"><span class="pre">`libpython2.7`</span></code>)</li>
<li>SSHPass(<code class="docutils literal notranslate"><span class="pre">`sshpass`</span></code>) to get working ssh password auth during playbook execution</li>
<li>GIT (<code class="docutils literal notranslate"><span class="pre">`git`</span></code>) to get working git import</li>
</ul>
<p>Required packages on Red Hat/CentOS :</p>
<ul class="simple">
<li>python (<code class="docutils literal notranslate"><span class="pre">`python`</span></code>)</li>
<li>OpenSSL (<code class="docutils literal notranslate"><span class="pre">`openssl-devel`</span></code>)</li>
<li>YAML (<code class="docutils literal notranslate"><span class="pre">`libyaml-devel`</span></code>)</li>
<li>virtualenv (<code class="docutils literal notranslate"><span class="pre">`python-virtualenv`</span></code>)</li>
<li>Kerberos (<code class="docutils literal notranslate"><span class="pre">`krb5-devel`</span></code>)</li>
<li>Libs for Kerberos (<code class="docutils literal notranslate"><span class="pre">`krb5-libs`</span></code>)</li>
<li>Open LDAP (<code class="docutils literal notranslate"><span class="pre">`openldap-devel`</span></code>)</li>
<li>GIT (<code class="docutils literal notranslate"><span class="pre">`git`</span></code>) to get working git import</li>
</ul>
</li>
<li><p class="first">Create virtualenv and activate it**:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>virualenv polemarch
<span class="nb">cd</span> polemarch
<span class="nb">source</span> bin/activate
</pre></div>
</div>
</li>
<li><p class="first">Install Polemarch:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install polemarch
</pre></div>
</div>
</li>
<li><p class="first">Edit config file:</p>
<ol class="arabic">
<li><p class="first">Open <cite>/etc/polemarch/settings.ini</cite>, if it does not exist, create it. Polemarch uses config from this directory.</p>
</li>
<li><p class="first">The default database is SQLite3, but MySQL is recommended. Settings needed for correct work database:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[database]</span>
<span class="na">engine</span> <span class="o">=</span> <span class="s">django.db.backends.mysql</span>
<span class="na">name</span> <span class="o">=</span> <span class="s">db_name</span>
<span class="na">user</span> <span class="o">=</span> <span class="s">db_user</span>
<span class="na">password</span> <span class="o">=</span> <span class="s">db_password</span>
<span class="na">host</span> <span class="o">=</span> <span class="s">db_host</span>
<span class="na">port</span> <span class="o">=</span> <span class="s">db_port</span>
</pre></div>
</div>
</li>
<li><p class="first">The default cache system is file based cache, but RedisCache is recommended. Settings needed for correct RedisCache work:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[cache]</span>
<span class="na">backend</span> <span class="o">=</span> <span class="s">django_redis.cache.RedisCache</span>
<span class="na">location</span> <span class="o">=</span> <span class="s">redis://redis-server:6379/1</span>

<span class="k">[locks]</span>
<span class="na">backend</span> <span class="o">=</span> <span class="s">django_redis.cache.RedisCache</span>
<span class="na">location</span> <span class="o">=</span> <span class="s">redis://redis-server:6379/2</span>
</pre></div>
</div>
</li>
<li><p class="first">The default celery broker is file Celery broker, but Redis is recommended. Settings needed for correct Redis work:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[rpc]</span>
<span class="na">connection</span> <span class="o">=</span> <span class="s">redis://redis-server:6379/3</span>
<span class="na">heartbeat</span> <span class="o">=</span> <span class="s">5</span>
<span class="na">concurrency</span> <span class="o">=</span> <span class="s">8</span>
<span class="na">enable_worker</span> <span class="o">=</span> <span class="s">true</span>
</pre></div>
</div>
</li>
<li><p class="first">For running Polemarch with worker, you need to create follow sections:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[uwsgi]</span>
<span class="na">processes</span> <span class="o">=</span> <span class="s">4</span>
<span class="na">threads</span> <span class="o">=</span> <span class="s">4</span>
<span class="na">harakiri</span> <span class="o">=</span> <span class="s">120</span>
<span class="na">vacuum</span> <span class="o">=</span> <span class="s">True</span>

<span class="k">[worker]</span>
<span class="na">logfile</span> <span class="o">=</span> <span class="s">/tmp/{PROG_NAME}_worker.log  # output will be /tmp/polemarch_worker.log</span>
<span class="na">pidfile</span> <span class="o">=</span> <span class="s">/tmp/{PROG_NAME}_worker.pid  # output will be /tmp/polemarch_worker.pid</span>
<span class="na">loglevel</span> <span class="o">=</span> <span class="s">INFO</span>
</pre></div>
</div>
<p>Also if you need to set your own path for logfile or pidfile,
different from the path from example, you can do it, but make sure,
that user, which starts Polemarch has write-permissions for these directory and file.</p>
</li>
</ol>
</li>
<li><p class="first">Make migrations:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>polemarchctl migrate
</pre></div>
</div>
</li>
<li><p class="first">Start Polemarch:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>polemarchctl webserver
</pre></div>
</div>
</li>
</ol>
<p>Polemarch starts with web interface on port 8080.</p>
<p>If you need to restart Polemarch use following command:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>polemarchctl webserver <span class="nv">reload</span><span class="o">=</span>/var/run/polemarch/web.pid
</pre></div>
</div>
</div></blockquote>
<p>If you use another directory for storing Polemarch pid file, use path to this file
instead of default <code class="docutils literal notranslate"><span class="pre">/var/run/polemarch/web.pid</span></code>.</p>
<p>If you need to stop Polemarch use following command:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>polemarchctl webserver <span class="nv">stop</span><span class="o">=</span>/var/run/polemarch/web.pid
</pre></div>
</div>
</div></blockquote>
<p>If you use another directory for storing Polemarch pid file, use path to this file
instead of default <code class="docutils literal notranslate"><span class="pre">/var/run/polemarch/web.pid</span></code>.</p>
</div>
<div class="section" id="quickstart">
<h2>Quickstart<a class="headerlink" href="#quickstart" title="Permalink to this headline">¶</a></h2>
<p>After you install Polemarch by instructions above you can use it without any
further configuration. Interface is pretty intuitive and common for any web
application.</p>
<p>Default installation is suitable for most simple and common cases, but
Polemarch is highly configurable system. If you need something more advanced
(scalability, dedicated DB, custom cache, logging or directories) you can
always configure Polemarch like it is said in <a class="reference internal" href="config.html"><span class="doc">Configuration manual</span></a>.</p>
</div>
<div class="section" id="backup">
<h2>Backup<a class="headerlink" href="#backup" title="Permalink to this headline">¶</a></h2>
<p>Regular uploading of backups is a guarantee of the reliability of the application.
There are several ways of making a backup. The first one is not very reliable, but if you want, you can use it.
To upload the data, use the command:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo -u polemarch /opt/polemarch/bin/polemarchctl dumpdata --natural-foreign --natural-primary -a --indent <span class="m">4</span> -o /home/polemarch/backup.json
</pre></div>
</div>
</div></blockquote>
<p>To load the saved data, use:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo -u polemarch /opt/polemarch/bin/polemarchctl loaddata /home/polemarch/backup.json
</pre></div>
</div>
</div></blockquote>
<p>The second way is to use SQL backup or to copy you database manually.
We strongly recommend to use this way of making a backup, because
it is faster and more reliale, than first one.</p>
<p>There are examples of SQL backup for MySQL and PostgreSQL below.</p>
<p>Making backup in MySQL:</p>
<blockquote>
<div><div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="n">shell</span><span class="o">&gt;</span> <span class="n">mysqldump</span> <span class="n">dbname</span> <span class="o">&gt;</span> <span class="n">dump</span><span class="p">.</span><span class="k">sql</span>
</pre></div>
</div>
</div></blockquote>
<p>Here dbname is the name of your database, dump.sql is the file, where all SQL backup statements
will be saved.</p>
<p>Uploading of backup in MySQL:</p>
<blockquote>
<div><div class="highlight-mysql notranslate"><div class="highlight"><pre><span></span><span class="n">shell</span><span class="o">&gt;</span> <span class="n">mysqladmin</span> <span class="k">create</span> <span class="n">dbname</span>
<span class="n">shell</span><span class="o">&gt;</span> <span class="n">mysql</span> <span class="n">dbname</span> <span class="o">&lt;</span> <span class="n">dump</span><span class="p">.</span><span class="k">sql</span>
</pre></div>
</div>
</div></blockquote>
<p>Making backup in PostgreSQL:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pg_dump dbname &gt; dump.sql
</pre></div>
</div>
</div></blockquote>
<p>Uploading of backup in PostgreSQL:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>createdb dbname
psql dbname &lt; dump.sql
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="update">
<h2>Update<a class="headerlink" href="#update" title="Permalink to this headline">¶</a></h2>
<p>Before updating of package of any type it is strongly recommended to stop all services and create backup for safety.</p>
</div>
<div class="section" id="update-to-0-2-x">
<h2>Update to 0.2.x<a class="headerlink" href="#update-to-0-2-x" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Firstly, we strongly recommend you to create a database backup and to stop all Polemarch services for safety.</li>
<li>Secondly, if you are updating from 0.1.x to 0.2.x, you need to update you current 0.1.x version to 0.1.13 version.</li>
<li>Then update 0.1.13 version to 0.2.x. If you don’t know how to do it, look <a class="reference internal" href="#"><span class="doc">“Install from PyPI”</span></a>.</li>
</ol>
</div>
<div class="section" id="migrate">
<h2>Migrate<a class="headerlink" href="#migrate" title="Permalink to this headline">¶</a></h2>
<p>Migrations are Django’s way of propagating changes you make to your models (adding a field, deleting a model, etc.)
into your database schema. They’re designed to be mostly automatic, but you need to know when to make migrations,
when to run them, and the common problems you might run into.</p>
<p>To run a <code class="docutils literal notranslate"><span class="pre">migrate</span></code> command you should run follow code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">polemarch</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polemarch</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">polemarchctl</span> <span class="n">migrate</span>
</pre></div>
</div>
</div>
<div class="section" id="create-superuser">
<h2>Create superuser<a class="headerlink" href="#create-superuser" title="Permalink to this headline">¶</a></h2>
<p>A superuser is the user, who has all permissions.</p>
<p>To create a superuser account use the follow command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">polemarch</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polemarch</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">polemarchctl</span> <span class="n">createsuperuser</span>
</pre></div>
</div>
<p>This command prompts for all required user’s options.</p>
</div>
<div class="section" id="change-password">
<h2>Change password<a class="headerlink" href="#change-password" title="Permalink to this headline">¶</a></h2>
<p>To change password use the follow command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">-</span><span class="n">u</span> <span class="n">polemarch</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">polemarch</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">polemarchctl</span> <span class="n">changepassword</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">username</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>It prompts you to enter a new password twice for the given user.
If the entries are identical, this immediately becomes the new password.
If you do not supply a user, the command will attempt to change the password of user whose username matches
the current user.</p>
</div>
</div>


                </div>
            </div>
        </section>
    </div>

    
    <footer class="main-footer">
         <div class="pull-right hidden-xs">
             &copy; 2018, VST Consulting
         </div>
        <br>
    </footer>
    
</div>

</body>

</html>

