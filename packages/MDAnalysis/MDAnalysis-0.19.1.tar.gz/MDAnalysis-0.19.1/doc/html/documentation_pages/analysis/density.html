
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>4.8.1. Generating densities from trajectories — MDAnalysis.analysis.density &#8212; MDAnalysis 0.18.1-dev documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within MDAnalysis 0.18.1-dev documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.8.2. Linear Density — MDAnalysis.analysis.lineardensity" href="lineardensity.html" />
    <link rel="prev" title="4.7.4. Dihedral and Ramachandran analysis — MDAnalysis.analysis.dihedrals" href="dihedrals.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-MDAnalysis.analysis.density"></span><div class="section" id="generating-densities-from-trajectories-mdanalysis-analysis-density">
<h1>4.8.1. Generating densities from trajectories — <a class="reference internal" href="#module-MDAnalysis.analysis.density" title="MDAnalysis.analysis.density"><code class="xref py py-mod docutils literal notranslate"><span class="pre">MDAnalysis.analysis.density</span></code></a><a class="headerlink" href="#generating-densities-from-trajectories-mdanalysis-analysis-density" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Oliver Beckstein</td>
</tr>
<tr class="field-even field"><th class="field-name">Year:</th><td class="field-body">2011</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">GNU Public License v3</td>
</tr>
</tbody>
</table>
<p>The module provides classes and functions to generate and represent
volumetric data, in particular densities.</p>
<div class="section" id="generating-a-density-from-a-md-trajectory">
<h2>4.8.1.1. Generating a density from a MD trajectory<a class="headerlink" href="#generating-a-density-from-a-md-trajectory" title="Permalink to this headline">¶</a></h2>
<p>A common use case is to analyze the solvent density around a protein of
interest. The density is calculated with <a class="reference internal" href="#MDAnalysis.analysis.density.density_from_Universe" title="MDAnalysis.analysis.density.density_from_Universe"><code class="xref py py-func docutils literal notranslate"><span class="pre">density_from_Universe()</span></code></a> in the
fixed coordinate system of the simulation unit cell. It is therefore necessary
to orient and fix the protein with respect to the box coordinate system. In
practice this means centering and superimposing the protein, frame by frame, on
a reference structure and translating and rotating all other components of the
simulation with the protein. In this way, the solvent will appear in the
reference frame of the protein.</p>
<p>An input trajectory must</p>
<ol class="arabic simple">
<li>have been centered on the protein of interest;</li>
<li>have all molecules made whole that have been broken across periodic
boundaries <a class="footnote-reference" href="#pbc" id="id1">[1]</a>;</li>
<li>have the solvent molecules remapped so that they are closest to the
solute (this is important when using triclinic unit cells such as
a dodecahedron or a truncated octahedron) <a class="footnote-reference" href="#pbc" id="id2">[1]</a>.</li>
<li>have a fixed frame of reference; for instance, by superimposing a protein
on a reference structure so that one can study the solvent density around
it <a class="footnote-reference" href="#fit" id="id3">[2]</a>.</li>
</ol>
<p>To generate the density of water molecules around a protein (assuming that the
trajectory is already appropriately treated for periodic boundary artifacts and
is suitably superimposed to provide a fixed reference frame) <a class="footnote-reference" href="#testraj" id="id4">[3]</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MDAnalysis.analysis.density</span> <span class="k">import</span> <span class="n">density_from_Universe</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Universe</span><span class="p">(</span><span class="n">TPR</span><span class="p">,</span> <span class="n">XTC</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">density_from_Universe</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">atomselection</span><span class="o">=</span><span class="s2">&quot;name OW&quot;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">convert_density</span><span class="p">(</span><span class="s1">&#39;TIP4P&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s2">&quot;water.dx&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>The positions of all water oxygens are histogrammed on a grid with spacing
<em>delta</em> = 1 Å. Initially the density is measured in <span class="math notranslate nohighlight">\(\text{Å}^{-3}\)</span>. With
the <a class="reference internal" href="#MDAnalysis.analysis.density.Density.convert_density" title="MDAnalysis.analysis.density.Density.convert_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.convert_density()</span></code></a> method, the units of measurement are
changed. In the example we are now measuring the density relative to the
literature value of the TIP4P water model at ambient conditions (see the values
in <a class="reference internal" href="../units.html#MDAnalysis.units.water" title="MDAnalysis.units.water"><code class="xref py py-data docutils literal notranslate"><span class="pre">MDAnalysis.units.water</span></code></a> for details). Finally, the density is written
as an <a class="reference external" href="http://www.opendx.org/">OpenDX</a> compatible file that can be read in <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/">VMD</a>, <a class="reference external" href="https://www.cgl.ucsf.edu/chimera/">Chimera</a>, or <a class="reference external" href="http://www.pymol.org/">PyMOL</a>.</p>
<p>See <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> for details. In particular, the density is stored
as a NumPy array in <a class="reference internal" href="#MDAnalysis.analysis.density.Density.grid" title="MDAnalysis.analysis.density.Density.grid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Density.grid</span></code></a>, which can be processed in
any manner.</p>
</div>
<div class="section" id="creating-densities">
<h2>4.8.1.2. Creating densities<a class="headerlink" href="#creating-densities" title="Permalink to this headline">¶</a></h2>
<p>The following functions take trajectory or coordinate data and generate a
<a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> object.</p>
<dl class="function">
<dt id="MDAnalysis.analysis.density.density_from_Universe">
<code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">density_from_Universe</code><span class="sig-paren">(</span><em>universe</em>, <em>delta=1.0</em>, <em>atomselection='name OH2'</em>, <em>start=None</em>, <em>stop=None</em>, <em>step=None</em>, <em>metadata=None</em>, <em>padding=2.0</em>, <em>cutoff=0</em>, <em>soluteselection=None</em>, <em>use_kdtree=True</em>, <em>update_selection=False</em>, <em>verbose=None</em>, <em>interval=1</em>, <em>quiet=None</em>, <em>parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#density_from_Universe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.density_from_Universe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a density grid from a <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object.</p>
<p>The trajectory is read, frame by frame, and the atoms selected with <cite>atomselection</cite> are
histogrammed on a grid with spacing <cite>delta</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>universe</strong> (<em>MDAnalysis.Universe</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code> object with a trajectory</li>
<li><strong>atomselection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – selection string (MDAnalysis syntax) for the species to be analyzed
[“name OH2”]</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – bin size for the density grid in Angstroem (same in x,y,z) [1.0]</li>
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – </li>
<li><strong>stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – </li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – Slice the trajectory as <code class="docutils literal notranslate"><span class="pre">trajectory[start:stop:step]</span></code>; default
is to read the whole trajectory.</li>
<li><strong>metadata</strong> (<em>dict. optional</em>) – <cite>dict</cite> of additional data to be saved with the object; the meta data
are passed through as they are.</li>
<li><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – increase histogram dimensions by padding (on top of initial box size)
in Angstroem [2.0]</li>
<li><strong>soluteselection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – MDAnalysis selection for the solute, e.g. “protein” [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
<li><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> (</em><em>optional</em><em>)</em>) – With <cite>cutoff</cite>, select “&lt;atomsel&gt; NOT WITHIN &lt;cutoff&gt; OF &lt;soluteselection&gt;”
(Special routines that are faster than the standard <code class="docutils literal notranslate"><span class="pre">AROUND</span></code> selection);
any value that evaluates to <code class="docutils literal notranslate"><span class="pre">False</span></code> (such as the default 0) disables this
special selection.</li>
<li><strong>update_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Should the selection of atoms be updated for every step? [<code class="docutils literal notranslate"><span class="pre">False</span></code>]</p>
<ul>
<li><code class="docutils literal notranslate"><span class="pre">True</span></code>: atom selection is updated for each frame, can be slow</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code>: atoms are only selected at the beginning</li>
</ul>
</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em> (</em><em>optional</em><em>)</em>) – <p>Print status update to the screen for every <em>interval</em> frame? [<code class="docutils literal notranslate"><span class="pre">True</span></code>]</p>
<ul>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code>: no status updates when a new frame is processed</li>
<li><code class="docutils literal notranslate"><span class="pre">True</span></code>: status update every frame (including number of atoms
processed, which is interesting with <code class="docutils literal notranslate"><span class="pre">update_selection=True</span></code>)</li>
</ul>
</li>
<li><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – Show status update every <cite>interval</cite> frame [1]</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em> (</em><em>optional</em><em>)</em>) – <cite>dict</cite> with some special parameters for <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> (see docs)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> instance with the histogrammed data together
with associated metadata.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>By default, the <cite>atomselection</cite> is static, i.e., atoms are only selected
once at the beginning. If you want <em>dynamically changing selections</em> (such
as “name OW and around 4.0 (protein and not name H*)”, i.e., the water
oxygen atoms that are within 4 Å of the protein heavy atoms) then set
<code class="docutils literal notranslate"><span class="pre">update_selection=True</span></code>. For the special case of calculating a density of
the “bulk” solvent away from a solute use the optimized selections with
keywords <em>cutoff</em> and <em>soluteselection</em> (see Examples below).</p>
<p class="rubric">Examples</p>
<p>Basic use for creating a water density (just using the water oxygen atoms “OW”):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">density</span> <span class="o">=</span> <span class="n">density_from_Universe</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">atomselection</span><span class="o">=</span><span class="s1">&#39;name OW&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you are only interested in water within a certain region, e.g., within a
vicinity around a binding site, you can use a selection that updates every
step by setting the <cite>update_selection</cite> keyword argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">site_density</span> <span class="o">=</span> <span class="n">density_from_Universe</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                                     <span class="n">atomselection</span><span class="o">=</span><span class="s1">&#39;name OW and around 5 (resid 156 157 305)&#39;</span><span class="p">,</span>
                                     <span class="n">update_selection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>A special case for an updating selection is to create the “bulk density”,
i.e., the water outside the immediate solvation shell of a protein: Select
all water oxygen atoms that are <em>farther away</em> than a given cut-off (say, 4
Å) from the solute (here, heavy atoms of the protein):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bulk</span> <span class="o">=</span> <span class="n">density_from_Universe</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">atomselection</span><span class="o">=</span><span class="s1">&#39;name OW&#39;</span><span class="p">,</span>
                             <span class="n">solute</span><span class="o">=</span><span class="s2">&quot;protein and not name H*&quot;</span><span class="p">,</span>
                             <span class="n">cutoff</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>(Using the special case for the bulk with <cite>soluteselection</cite> and <cite>cutoff</cite>
improves performance over the simple <cite>update_selection</cite> approach.)</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 0.13.0: </span><em>update_selection</em> and <em>quiet</em> keywords added</p>
</div>
<div class="deprecated">
<p><span class="versionmodified">Deprecated since version 0.16: </span>The keyword argument <em>quiet</em> is deprecated in favor of <em>verbose</em>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.density.density_from_PDB">
<code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">density_from_PDB</code><span class="sig-paren">(</span><em>pdb</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#density_from_PDB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.density_from_PDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a density from a single frame PDB.</p>
<p>Typical use is to make a density from the crystal water
molecules. The density is created from isotropic gaussians
centered at each selected atoms. If B-factors are present in the
file then they are used to calculate the width of the gaussian.</p>
<p>Using the <em>sigma</em> keyword, one can override this choice and
prescribe a gaussian width for all atoms (in Angstrom), which is
calculated as described for <a class="reference internal" href="#MDAnalysis.analysis.density.Bfactor2RMSF" title="MDAnalysis.analysis.density.Bfactor2RMSF"><code class="xref py py-func docutils literal notranslate"><span class="pre">Bfactor2RMSF()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pdb</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – PDB filename (should have the temperatureFactor set); ANISO
records are currently <em>not</em> processed</li>
<li><strong>atomselection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – selection string (MDAnalysis syntax) for the species to be analyzed
[‘resname HOH and name O’]</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – bin size for the density grid in Angstroem (same in x,y,z) [1.0]</li>
<li><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – dictionary of additional data to be saved with the object [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
<li><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – increase histogram dimensions by padding (on top of initial box size) [1.0]</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – width (in Angstrom) of the gaussians that are used to build up the
density; if <code class="docutils literal notranslate"><span class="pre">None</span></code> then uses B-factors from <em>pdb</em> [<code class="docutils literal notranslate"><span class="pre">None</span></code>]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">object with a density measured relative to the water density at
standard conditions</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The current implementation is <em>painfully</em> slow.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.density.Bfactor2RMSF" title="MDAnalysis.analysis.density.Bfactor2RMSF"><code class="xref py py-func docutils literal notranslate"><span class="pre">Bfactor2RMSF()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.density.Bfactor2RMSF">
<code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">Bfactor2RMSF</code><span class="sig-paren">(</span><em>B</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#Bfactor2RMSF"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.Bfactor2RMSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Atomic root mean square fluctuation (in Angstrom) from the crystallographic B-factor</p>
<p>RMSF and B-factor are related by <a class="reference internal" href="#willis1975" id="id5">[Willis1975]</a></p>
<div class="math notranslate nohighlight">
\[B = \frac{8\pi^2}{3} \rm{RMSF}^2\]</div>
<p>and this function returns</p>
<div class="math notranslate nohighlight">
\[\rm{RMSF} = \sqrt{\frac{3 B}{8\pi^2}}\]</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="willis1975" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[Willis1975]</a></td><td>BTM Willis and AW Pryor. <em>Thermal vibrations in crystallography</em>. Cambridge Univ. Press, 1975</td></tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="supporting-classes-and-functions">
<h2>4.8.1.3. Supporting classes and functions<a class="headerlink" href="#supporting-classes-and-functions" title="Permalink to this headline">¶</a></h2>
<p>The main output of the density creation functions is a
<a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> instance, which is derived from a
<a class="reference external" href="https://www.mdanalysis.org/GridDataFormats/gridData/core.html#gridData.core.Grid" title="(in GridDataFormats v0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gridData.core.Grid</span></code></a>. A <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> is essentially, a 3D
array with origin and lengths together with associated metadata (which
can be used in downstream processing).</p>
<dl class="class">
<dt id="MDAnalysis.analysis.density.Density">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">Density</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#Density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://www.mdanalysis.org/GridDataFormats/gridData/core.html#gridData.core.Grid" title="(in GridDataFormats v0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gridData.core.Grid</span></code></a></p>
<p>Class representing a density on a regular cartesian grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>grid</strong> (<em>array_like</em>) – histogram or density, typically a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.15)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></li>
<li><strong>edges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – list of arrays, the lower and upper bin edges along the axes</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – <p>dictionary of class parameters; saved with
<a class="reference internal" href="#MDAnalysis.analysis.density.Density.save" title="MDAnalysis.analysis.density.Density.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.save()</span></code></a>. The following keys are meaningful to
the class. Meaning of the values are listed:</p>
<blockquote>
<div><em>isDensity</em><blockquote>
<div><ul>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code>: grid is a histogram with counts [default]</li>
<li><code class="docutils literal notranslate"><span class="pre">True</span></code>: a density</li>
</ul>
<p>Applying <code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.make_density`()</span></code> sets it to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div></blockquote>
</div></blockquote>
</li>
<li><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – <p>A dict with the keys</p>
<ul>
<li><em>length</em>:  physical unit of grid edges (Angstrom or nm) [Angstrom]</li>
<li><em>density</em>: unit of the density if <code class="docutils literal notranslate"><span class="pre">isDensity=True</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>
otherwise; the default is “Angstrom^{-3}” for densities
(meaning <span class="math notranslate nohighlight">\(\text{Å}^{-3}\)</span>).</li>
</ul>
<p>(Actually, the default unit is the value of
<code class="docutils literal notranslate"><span class="pre">MDAnalysis.core.flags['length_unit']</span></code>; in most
cases this is “Angstrom”.)</p>
</li>
<li><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – a user defined dictionary of arbitrary values associated with the
density; the class does not touch <code class="xref py py-attr docutils literal notranslate"><span class="pre">Density.metadata</span></code> but
stores it with <a class="reference internal" href="#MDAnalysis.analysis.density.Density.save" title="MDAnalysis.analysis.density.Density.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.save()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.grid">
<code class="descname">grid</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.grid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array</em> – counts or density</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.edges">
<code class="descname">edges</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.edges" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of 1d-arrays</em> – The boundaries of each cell in <cite>grid</cite> along all axes (equivalent
to what <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogramdd.html#numpy.histogramdd" title="(in NumPy v1.15)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.histogramdd()</span></code></a> returns).</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.delta">
<code class="descname">delta</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.delta" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array</em> – Cell size in each dimension.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.origin">
<code class="descname">origin</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.origin" title="Permalink to this definition">¶</a></dt>
<dd><p><em>array</em> – Coordinates of the <em>center</em> of the cell at index <cite>grid[0, 0, 0, …,
0]</cite>, which is considered to be the front lower left corner.</p>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.units">
<code class="descname">units</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.units" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – The units for lengths and density; change units with the method
<a class="reference internal" href="#MDAnalysis.analysis.density.Density.convert_length" title="MDAnalysis.analysis.density.Density.convert_length"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convert_length()</span></code></a> or <a class="reference internal" href="#MDAnalysis.analysis.density.Density.convert_density" title="MDAnalysis.analysis.density.Density.convert_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">convert_density()</span></code></a>.</p>
</dd></dl>

<p class="rubric">Notes</p>
<p>The data (<a class="reference internal" href="#MDAnalysis.analysis.density.Density.grid" title="MDAnalysis.analysis.density.Density.grid"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Density.grid</span></code></a>) can be manipulated as a standard numpy
array. Changes can be saved to a file using the <a class="reference internal" href="#MDAnalysis.analysis.density.Density.save" title="MDAnalysis.analysis.density.Density.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.save()</span></code></a> method. The
grid can be restored using the <a class="reference internal" href="#MDAnalysis.analysis.density.Density.load" title="MDAnalysis.analysis.density.Density.load"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.load()</span></code></a> method or by supplying the
filename to the constructor.</p>
<p>The attribute <code class="xref py py-attr docutils literal notranslate"><span class="pre">Density.metadata</span></code> holds a user-defined dictionary that
can be used to annotate the data. It is also saved with <a class="reference internal" href="#MDAnalysis.analysis.density.Density.save" title="MDAnalysis.analysis.density.Density.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.save()</span></code></a>.</p>
<p>The <a class="reference internal" href="#MDAnalysis.analysis.density.Density.export" title="MDAnalysis.analysis.density.Density.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.export()</span></code></a> method always exports a 3D object (written in
such a way to be readable in <a class="reference external" href="http://www.ks.uiuc.edu/Research/vmd/">VMD</a>, <a class="reference external" href="https://www.cgl.ucsf.edu/chimera/">Chimera</a>, and <a class="reference external" href="http://www.pymol.org/">PyMOL</a>), the rest should
work for an array of any dimension. Note that <a class="reference external" href="http://www.pymol.org/">PyMOL</a> only understands DX
files with the DX data type “double” in the “array” object (see <a class="reference external" href="https://www.mdanalysis.org/GridDataFormats/gridData/formats/OpenDX.html#known-issues-for-writing-opendx-files">known
issues when writing OpenDX files</a> and issue
<a class="reference external" href="https://github.com/MDAnalysis/GridDataFormats/issues/35">MDAnalysis/GridDataFormats#35</a> for details). Using the keyword
<code class="docutils literal notranslate"><span class="pre">type=&quot;double&quot;</span></code> for the method <a class="reference internal" href="#MDAnalysis.analysis.density.Density.export" title="MDAnalysis.analysis.density.Density.export"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.export()</span></code></a>, the user can
ensure that the DX file is written in a format suitable for <a class="reference external" href="http://www.pymol.org/">PyMOL</a>.</p>
<p>If the input histogram consists of counts per cell then the
<a class="reference internal" href="#MDAnalysis.analysis.density.Density.make_density" title="MDAnalysis.analysis.density.Density.make_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.make_density()</span></code></a> method converts the grid to a physical density. For
a probability density, divide it by <code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.grid.sum()</span></code> or use <code class="docutils literal notranslate"><span class="pre">normed=True</span></code>
right away in <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.histogramdd.html#numpy.histogramdd" title="(in NumPy v1.15)"><code class="xref py py-func docutils literal notranslate"><span class="pre">histogramdd()</span></code></a>.</p>
<p>The user <em>should</em> set the <em>parameters</em> keyword (see docs for the
constructor); in particular, if the data are already a density, one must
set <code class="docutils literal notranslate"><span class="pre">isDensity=True</span></code> because there is no reliable way to detect if
data represent counts or a density. As a special convenience, if data are
read from a file and the user has not set <code class="docutils literal notranslate"><span class="pre">isDensity</span></code> then it is assumed
that the data are in fact a density.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference external" href="https://www.mdanalysis.org/GridDataFormats/gridData/core.html#gridData.core.Grid" title="(in GridDataFormats v0.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">gridData.core.Grid</span></code></a></dt>
<dd>the base class of <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a>.</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Typical use:</p>
<ol class="arabic">
<li><p class="first">From a histogram (i.e. counts on a grid):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="p">,</span><span class="n">edges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">histogramdd</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">D</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">edges</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isDensity&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="n">units</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">})</span>
<span class="n">D</span><span class="o">.</span><span class="n">make_density</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">From a saved density file (e.g. in OpenDX format), where the lengths are
in Angstrom and the density in 1/A**3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span><span class="s2">&quot;density.dx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">From a saved density file (e.g. in OpenDX format), where the lengths are
in Angstrom and the density is measured relative to the density of water
at ambient conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span><span class="s2">&quot;density.dx&quot;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;density&#39;</span><span class="p">:</span> <span class="s1">&#39;water&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first">From a saved <em>histogram</em> (less common, but in order to demonstrate the
<em>parameters</em> keyword) where the lengths are in nm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span> <span class="o">=</span> <span class="n">Density</span><span class="p">(</span><span class="s2">&quot;counts.dx&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;isDensity&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span> <span class="n">units</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="s1">&#39;nm&#39;</span><span class="p">})</span>
<span class="n">D</span><span class="o">.</span><span class="n">make_density</span><span class="p">()</span>
<span class="n">D</span><span class="o">.</span><span class="n">convert_length</span><span class="p">(</span><span class="s1">&#39;Angstrom^{-3}&#39;</span><span class="p">)</span>
<span class="n">D</span><span class="o">.</span><span class="n">convert_density</span><span class="p">(</span><span class="s1">&#39;water&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>After the final step, <code class="docutils literal notranslate"><span class="pre">D</span></code> will contain a density on a grid measured in
Ångstrom, with the density values itself measured relative to the
density of water.</p>
</li>
</ol>
<p><a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> objects can be algebraically manipulated (added,
subtracted, multiplied, …)  but there are <em>no sanity checks</em> in place to
make sure that units, metadata, etc are compatible!</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is suggested to construct the Grid object from a histogram,
to supply the appropriate length unit, and to use
<a class="reference internal" href="#MDAnalysis.analysis.density.Density.make_density" title="MDAnalysis.analysis.density.Density.make_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Density.make_density()</span></code></a> to obtain a density. This ensures
that the length- and the density unit correspond to each other.</p>
</div>
<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.centers">
<code class="descname">centers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.centers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinates of the centers of all grid cells as an
iterator.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.check_compatible">
<code class="descname">check_compatible</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.check_compatible" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <em>other</em> can be used in an arithmetic operation.</p>
<ol class="arabic simple">
<li><em>other</em> is a scalar</li>
<li><em>other</em> is a grid defined on the same edges</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">TypeError</span></code></a> if not compatible.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.convert_density">
<code class="descname">convert_density</code><span class="sig-paren">(</span><em>unit='Angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#Density.convert_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.Density.convert_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the density to the physical units given by <cite>unit</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – <p>The target unit that the density should be converted to.</p>
<p><cite>unit</cite> can be one of the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">description of the unit</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Angstrom^{-3}</td>
<td>particles/A**3</td>
</tr>
<tr class="row-odd"><td>nm^{-3}</td>
<td>particles/nm**3</td>
</tr>
<tr class="row-even"><td>SPC</td>
<td>density of SPC water at standard conditions</td>
</tr>
<tr class="row-odd"><td>TIP3P</td>
<td>… see <a class="reference internal" href="../units.html#MDAnalysis.units.water" title="MDAnalysis.units.water"><code class="xref py py-data docutils literal notranslate"><span class="pre">MDAnalysis.units.water</span></code></a></td>
</tr>
<tr class="row-even"><td>TIP4P</td>
<td>… see <a class="reference internal" href="../units.html#MDAnalysis.units.water" title="MDAnalysis.units.water"><code class="xref py py-data docutils literal notranslate"><span class="pre">MDAnalysis.units.water</span></code></a></td>
</tr>
<tr class="row-odd"><td>water</td>
<td>density of real water at standard conditions (0.997 g/cm**3)</td>
</tr>
<tr class="row-even"><td>Molar</td>
<td>mol/l</td>
</tr>
</tbody>
</table>
</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> – If the density does not have a unit associated with it to begin
with (i.e., is not a density) then no conversion can take place.</li>
<li><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code></a> – for unknown <cite>unit</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic simple">
<li>This method only works if there is already a length unit associated with the
density; otherwise raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.7)"><code class="xref py py-exc docutils literal notranslate"><span class="pre">RuntimeError</span></code></a></li>
<li>Conversions always go back to unity so there can be rounding
and floating point artifacts for multiple conversions.</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.convert_length">
<code class="descname">convert_length</code><span class="sig-paren">(</span><em>unit='Angstrom'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#Density.convert_length"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.Density.convert_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Grid object to the new <cite>unit</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – unit that the grid should be converted to: one of
“Angstrom”, “nm”</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This changes the edges but will not change the density; it is the
user’s responsibility to supply the appropriate unit if the Grid object
is constructed from a density. It is suggested to start from a
histogram and a length unit and use <a class="reference internal" href="#MDAnalysis.analysis.density.Density.make_density" title="MDAnalysis.analysis.density.Density.make_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_density()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.export">
<code class="descname">export</code><span class="sig-paren">(</span><em>filename</em>, <em>file_format=None</em>, <em>type=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.export" title="Permalink to this definition">¶</a></dt>
<dd><p>export density to file using the given format.</p>
<p>The format can also be deduced from the suffix of the filename
though the <em>format</em> keyword takes precedence.</p>
<p>The default format for export() is ‘dx’.  Use ‘dx’ for
visualization.</p>
<p>Implemented formats:</p>
<dl class="docutils">
<dt>dx</dt>
<dd><code class="xref py py-mod docutils literal notranslate"><span class="pre">OpenDX</span></code></dd>
<dt>pickle</dt>
<dd>pickle (use :meth:<code class="docutils literal notranslate"><span class="pre">Grid.load`</span> <span class="pre">to</span> <span class="pre">restore);</span> <span class="pre">:meth:`Grid.save`</span>
<span class="pre">is</span> <span class="pre">simpler</span> <span class="pre">than</span> <span class="pre">``export(format='python')</span></code>.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – name of the output file</li>
<li><strong>file_format</strong> (<em>{'dx'</em><em>, </em><em>'pickle'</em><em>, </em><em>None}</em><em> (</em><em>optional</em><em>)</em>) – output file format, the default is “dx”</li>
<li><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> (</em><em>optional</em><em>)</em>) – <p>for DX, set the output DX array type, e.g., “double” or
“float”; note that PyMOL only understands “double” (see
issue <a class="reference external" href="https://github.com/MDAnalysis/GridDataFormats/issues/35">#35</a>). By default (<code class="docutils literal notranslate"><span class="pre">None</span></code>), the DX type is
determined from the numpy dtype of the array of the grid
(and this will typically result in “double”).</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 0.4.0.</span></p>
</div>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="MDAnalysis.analysis.density.Density.interpolated">
<code class="descname">interpolated</code><a class="headerlink" href="#MDAnalysis.analysis.density.Density.interpolated" title="Permalink to this definition">¶</a></dt>
<dd><p>B-spline function over the data grid(x,y,z).</p>
<blockquote>
<div>interpolated([x1,x2,…],[y1,y2,…],[z1,z2,…]) -&gt; F[x1,y1,z1],F[x2,y2,z2],…</div></blockquote>
<p>The interpolation order is set in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Grid.interpolation_spline_order</span></code>.</p>
<p>The interpolated function is computed once and is cached for better
performance. Whenever <code class="xref py py-attr docutils literal notranslate"><span class="pre">interpolation_spline_order</span></code> is
modified, <code class="xref py py-meth docutils literal notranslate"><span class="pre">Grid.interpolated()</span></code> is recomputed.</p>
<p>The value for unknown data is set in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Grid.interpolation_cval</span></code>
(TODO: also recompute when interpolation_cval value is changed.)</p>
<dl class="docutils">
<dt>Example usage for resampling::</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">XX</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span><span class="n">ZZ</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">40</span><span class="p">:</span><span class="mi">75</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">96</span><span class="p">:</span><span class="mi">150</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FF</span> <span class="o">=</span> <span class="n">interpolated</span><span class="p">(</span><span class="n">XX</span><span class="p">,</span><span class="n">YY</span><span class="p">,</span><span class="n">ZZ</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>filename</em>, <em>file_format=None</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load saved (pickled or dx) grid and edges from &lt;filename&gt;.pickle</p>
<blockquote>
<div>Grid.load(&lt;filename&gt;.pickle)
Grid.load(&lt;filename&gt;.dx)</div></blockquote>
<p>The load() method calls the class’s constructor method and
completely resets all values, based on the loaded data.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.make_density">
<code class="descname">make_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#Density.make_density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.Density.make_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the grid (a histogram, counts in a cell) to a density (counts/volume).</p>
<p>This method changes the grid irrevocably.</p>
<p>For a probability density, manually divide by <code class="xref py py-meth docutils literal notranslate"><span class="pre">grid.sum()</span></code>.</p>
<p>If this is already a density, then a warning is issued and nothing is
done, so calling <cite>make_density</cite> multiple times does not do any harm.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.resample">
<code class="descname">resample</code><span class="sig-paren">(</span><em>edges</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.resample" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample data to a new grid with edges <em>edges</em>.</p>
<blockquote>
<div>resample(edges) –&gt; Grid</div></blockquote>
<p>or</p>
<blockquote>
<div>resample(otherGrid) –&gt; Grid</div></blockquote>
<p>The order of the interpolation is set by
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Grid.interpolation_spline_order</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.resample_factor">
<code class="descname">resample_factor</code><span class="sig-paren">(</span><em>factor</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.resample_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Resample to a new regular grid with factor*oldN cells along
each dimension.</p>
</dd></dl>

<dl class="method">
<dt id="MDAnalysis.analysis.density.Density.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#MDAnalysis.analysis.density.Density.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a grid object to &lt;filename&gt;.pickle</p>
<blockquote>
<div>Grid.save(filename)</div></blockquote>
<p>Internally, this calls Grid.export(filename,format=”python”). A grid can be
regenerated from the saved data with</p>
<blockquote>
<div>g = Grid(filename=&lt;filename&gt;)</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="MDAnalysis.analysis.density.BfactorDensityCreator">
<em class="property">class </em><code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">BfactorDensityCreator</code><span class="sig-paren">(</span><em>pdb</em>, <em>delta=1.0</em>, <em>atomselection='resname HOH and name O'</em>, <em>metadata=None</em>, <em>padding=1.0</em>, <em>sigma=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#BfactorDensityCreator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.BfactorDensityCreator" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a density grid from a pdb file using MDAnalysis.</p>
<p>The main purpose of this function is to convert crystal waters in
an X-ray structure into a density so that one can compare the
experimental density with the one from molecular dynamics
trajectories. Because a pdb is a single snapshot, the density is
estimated by placing Gaussians of width sigma at the position of
all selected atoms.</p>
<p>Sigma can be fixed or taken from the B-factor field, in which case
sigma is taken as sqrt(3.*B/8.)/pi (see <code class="xref py py-func docutils literal notranslate"><span class="pre">BFactor2RMSF()</span></code>).</p>
<p>Construct the density from psf and pdb and the atomselection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pdb</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – PDB file or <code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.Universe</span></code>;</li>
<li><strong>atomselection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – selection string (MDAnalysis syntax) for the species to be analyzed</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – bin size for the density grid in Angstroem (same in x,y,z) [1.0]</li>
<li><strong>metadata</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – dictionary of additional data to be saved with the object</li>
<li><strong>padding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – increase histogram dimensions by padding (on top of initial box size)</li>
<li><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – width (in Angstrom) of the gaussians that are used to build up the
density; if <code class="docutils literal notranslate"><span class="pre">None</span></code> (the default) then uses B-factors from pdb</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For assigning X-ray waters to MD densities one might have to use a sigma
of about 0.5 A to obtain a well-defined and resolved x-ray water density
that can be easily matched to a broader density distribution.</p>
<p class="rubric">Examples</p>
<p>The following creates the density with the B-factors from the pdb file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DC</span> <span class="o">=</span> <span class="n">BfactorDensityCreator</span><span class="p">(</span><span class="n">pdb</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">atomselection</span><span class="o">=</span><span class="s2">&quot;name HOH&quot;</span><span class="p">,</span>
                           <span class="n">padding</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">DC</span><span class="o">.</span><span class="n">Density</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#MDAnalysis.analysis.density.density_from_PDB" title="MDAnalysis.analysis.density.density_from_PDB"><code class="xref py py-func docutils literal notranslate"><span class="pre">density_from_PDB()</span></code></a></p>
</div>
<dl class="method">
<dt id="MDAnalysis.analysis.density.BfactorDensityCreator.Density">
<code class="descname">Density</code><span class="sig-paren">(</span><em>threshold=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#BfactorDensityCreator.Density"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.BfactorDensityCreator.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a <a class="reference internal" href="#MDAnalysis.analysis.density.Density" title="MDAnalysis.analysis.density.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> object.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="MDAnalysis.analysis.density.notwithin_coordinates_factory">
<code class="descclassname">MDAnalysis.analysis.density.</code><code class="descname">notwithin_coordinates_factory</code><span class="sig-paren">(</span><em>universe</em>, <em>sel1</em>, <em>sel2</em>, <em>cutoff</em>, <em>not_within=True</em>, <em>use_kdtree=True</em>, <em>updating_selection=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/MDAnalysis/analysis/density.html#notwithin_coordinates_factory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#MDAnalysis.analysis.density.notwithin_coordinates_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate optimized selection for ‘<em>sel1</em> not within <em>cutoff</em> of <em>sel2</em>’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>universe</strong> (<em>MDAnalysis.Universe</em>) – Universe object on which to operate</li>
<li><strong>sel1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Selection string for the <em>solvent</em> selection (should be
the group with the <em>larger number of atoms</em> to make the
KD-Tree search more efficient)</li>
<li><strong>sel2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Selection string for the <em>solute</em> selection</li>
<li><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Distance cutoff</li>
<li><strong>not_within</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – <ul>
<li><code class="docutils literal notranslate"><span class="pre">True</span></code>: selection behaves as “not within” (As described above)</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code>: selection is a “&lt;sel1&gt; WITHIN &lt;cutoff&gt; OF &lt;sel2&gt;”</li>
</ul>
</li>
<li><strong>use_kdtree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – <ul>
<li><code class="docutils literal notranslate"><span class="pre">True</span></code>: use fast KD-Tree based selections</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code>: use distance matrix approach</li>
</ul>
</li>
<li><strong>updating_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, re-evaluate the selection string each frame.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ul class="simple">
<li>Periodic boundary conditions are <em>not</em> taken into account: the naive
minimum image convention employed in the distance check is currently
not being applied to remap the coordinates themselves, and hence it
would lead to counts in the wrong region.</li>
<li>With <code class="docutils literal notranslate"><span class="pre">updating_selection=True</span></code>, the selection is evaluated every turn;
do not use distance based selections (such as “AROUND”) in your selection
string because it will likely completely negate any gains from using
this function factory in the first place.</li>
</ul>
<p class="rubric">Examples</p>
<p><a class="reference internal" href="#MDAnalysis.analysis.density.notwithin_coordinates_factory" title="MDAnalysis.analysis.density.notwithin_coordinates_factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">notwithin_coordinates_factory()</span></code></a> creates an optimized function that, when called,
returns the coordinates of the “solvent” selection that are <em>not within</em> a given cut-off
distance of the “solute”. Because it is KD-tree based, it is cheap to query the KD-tree with
a different cut-off:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">notwithin_coordinates</span> <span class="o">=</span> <span class="n">notwithin_coordinates_factory</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="s1">&#39;name OH2&#39;</span><span class="p">,</span> <span class="s1">&#39;protein and not name H*&#39;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">notwithin_coordinates</span><span class="p">()</span>        <span class="c1"># get coordinates outside cutoff 3.5 A</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">notwithin_coordinates</span><span class="p">(</span><span class="n">cutoff2</span><span class="p">)</span> <span class="c1"># can use different cut off</span>
</pre></div>
</div>
<p>For programmatic convenience, the function can also function as a factory for a simple
<em>within cutoff</em> query if the keyword <code class="docutils literal notranslate"><span class="pre">not_within=False</span></code> is set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">within_coordinates</span> <span class="o">=</span> <span class="n">notwithin_coordinates_factory</span><span class="p">(</span><span class="n">universe</span><span class="p">,</span> <span class="s1">&#39;name OH2&#39;</span><span class="p">,</span><span class="s1">&#39;protein and not name H*&#39;</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span>
                                                   <span class="n">not_within</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">within_coordinates</span><span class="p">()</span>        <span class="c1"># get coordinates within cutoff 3.5 A</span>
<span class="n">coord</span> <span class="o">=</span> <span class="n">within_coordinates</span><span class="p">(</span><span class="n">cutoff2</span><span class="p">)</span> <span class="c1"># can use different cut off</span>
</pre></div>
</div>
<p>(Readability is enhanced by properly naming the generated function
<code class="docutils literal notranslate"><span class="pre">within_coordinates()</span></code>.)</p>
</dd></dl>

<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="pbc" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id7">3</a>)</em> <p>Making molecules whole can be accomplished with the
<a class="reference internal" href="../core/groups.html#MDAnalysis.core.groups.AtomGroup.wrap" title="MDAnalysis.core.groups.AtomGroup.wrap"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MDAnalysis.core.groups.AtomGroup.wrap()</span></code></a> of
<code class="xref py py-attr docutils literal notranslate"><span class="pre">Universe.atoms</span></code> (use <code class="docutils literal notranslate"><span class="pre">compound=&quot;fragments&quot;</span></code>).</p>
<p>When using, for instance, the <a class="reference external" href="http://www.gromacs.org">Gromacs</a> command <a class="reference external" href="http://manual.gromacs.org/programs/gmx-trjconv.html">gmx trjconv</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx trjconv -pbc mol -center -ur compact
</pre></div>
</div>
<p class="last">one can make the molecules whole <code class="docutils literal notranslate"><span class="pre">-pbc</span> <span class="pre">whole</span></code>, center it on a group
(<code class="docutils literal notranslate"><span class="pre">-center</span></code>), and also pack all molecules in a compact unitcell
representation, which can be useful for density generation.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="fit" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td><p class="first">Superposition can be performed with
<a class="reference internal" href="align.html#MDAnalysis.analysis.align.AlignTraj" title="MDAnalysis.analysis.align.AlignTraj"><code class="xref py py-class docutils literal notranslate"><span class="pre">MDAnalysis.analysis.align.AlignTraj</span></code></a>.</p>
<p>The <a class="reference external" href="http://www.gromacs.org">Gromacs</a> command <a class="reference external" href="http://manual.gromacs.org/programs/gmx-trjconv.html">gmx trjconv</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gmx trjconv -fit rot+trans
</pre></div>
</div>
<p class="last">will also accomplish such a superposition. Note that the fitting has
to be done in a <em>separate</em> step from the treatment of the periodic
boundaries <a class="footnote-reference" href="#pbc" id="id7">[1]</a>.</p>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="testraj" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>Note that the trajectory in the example (<cite>XTC</cite>) is <em>not</em> properly
made whole and fitted to a reference structure; these steps were
omitted to clearly show the steps necessary for the actual density
calculation.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logos/mdanalysis-logo-200x150.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=MDAnalysis&repo=mdanalysis&type=star&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">1. Overview over MDAnalysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../topology.html">2. The topology system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections.html">3. Selection commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../analysis_modules.html">4. Analysis modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#building-blocks-for-analysis">4.1. Building blocks for Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#distances-and-contacts">4.2. Distances and contacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#hydrogen-bonding">4.3. Hydrogen bonding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#membranes-and-membrane-proteins">4.4. Membranes and membrane proteins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#nucleic-acids">4.5. Nucleic acids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#polymers">4.6. Polymers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#structure">4.7. Structure</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../analysis_modules.html#volumetric-analysis">4.8. Volumetric analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">4.8.1. Generating densities from trajectories — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.density</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#generating-a-density-from-a-md-trajectory">4.8.1.1. Generating a density from a MD trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-densities">4.8.1.2. Creating densities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#supporting-classes-and-functions">4.8.1.3. Supporting classes and functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lineardensity.html">4.8.2. Linear Density — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.lineardensity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="waterdynamics.html">4.8.3. Water dynamics analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.waterdynamics</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#dimensionality-reduction">4.9. Dimensionality Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../analysis_modules.html#legacy-analysis-modules">4.10. Legacy analysis modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../topology_modules.html">5. Topology modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coordinates_modules.html">6. Coordinates modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trajectory_transformations.html">7. Trajectory transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../selections_modules.html">8. Selection exporters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auxiliary_modules.html">9. Auxiliary modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core_modules.html">10. Core modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../visualization_modules.html">11. Visualization modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lib_modules.html">12. Library functions — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.lib</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../version.html">13. Version information for MDAnalysis - <code class="docutils literal notranslate"><span class="pre">MDAnalysis.version</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">14. Constants and unit conversion — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.units</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../exceptions.html">15. Custom exceptions and warnings — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.exceptions</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">16. References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../analysis_modules.html">4. Analysis modules</a><ul>
      <li>Previous: <a href="dihedrals.html" title="previous chapter">4.7.4. Dihedral and Ramachandran analysis — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.dihedrals</span></code></a></li>
      <li>Next: <a href="lineardensity.html" title="next chapter">4.8.2. Linear Density — <code class="docutils literal notranslate"><span class="pre">MDAnalysis.analysis.lineardensity</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2005-2017, Naveen Michaud-Agrawal, Elizabeth J. Denning, Christian Beckstein (logo), Joshua L. Adelman, Shobhit Agarwal, Balasubramanian, Utkarsh Bansal, Jonathan Barnoud, Tone Bengtsen, Alejandro Bernardin, Mateusz Bieniek, Wouter Boomsma, Jose Borreguero, Bart Bruininks, Sébastien Buchoux, Sören von Bülow, David Caplan, Matthieu Chavent, Kathleen Clark, Davide Cruz, Robert Delgado, John Detlefs, Xavier Deupi, Jan Domanski, David L. Dotson, Shujie Fan, Lennard van der Feltz, Philip Fowler, Joseph Goose, Richard J. Gowers, Lukas Grossar, Abhinav Gupta, Akshay Gupta, Benjamin Hall, Eugen Hruska, Kyle J. Huston, Joe Jordan, Jon Kapla, Navya Khare, Andrew William King, Max Linke, Jinju Lu, Micaela Matta, Robert McGibbon, Manuel Nuno Melo, Dominik 'Rathann' Mierzejewski, Henry Mull, Fiona Naughton, Alex Nesterenko, Hai Nguyen, Sang Young Noh, Nabarun Pal, Mattia F. Palermo, Danny Parton, Joshua L. Phillips, Vedant Rathore, Tyler Reddy, Paul Rigor, Carlos Yanez S., Utkarsh Saxena, Sean L. Seyler, Andy Somogyi, Caio S. Souza, Shantanu Srivastava, Lukas Stelzl, Gorman Stock, Ayush Suhane, Matteo Tiberti, Isaac Virshup, Nestor Wendt, Zhiyi Wu, Zhuyi Xue, Juan Eiros Zamora, Johannes Zeman, and Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/documentation_pages/analysis/density.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/mdanalysis" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>