{"version":3,"sources":["wizard.js"],"names":["$","fn","wizard","_this","this","config","arguments","length","undefined","$navItems","find","$activeNavItem","$activeWizardPane","$panes","filter","isLastPane","index","classes","tooltip","name","getButton","switchToPane","removeClass","eq","addClass","disablePrevious","remove","disableNext","redirectOnLastPane","hidePrevious","gettext","data","skip","skipTooltip","addActionBarToActivePane","next","pubFuncs","submit","$form","clearErrors","traditional","serializeForm","done","window","on","renderFormErrors","location","previous","err","responseJSON","jQuery"],"mappings":"cAQC,SAASA,GACNA,EAAEC,GAAGC,OAAS,WAAoB,IAAAC,EAAAC,KAAXC,EAAW,EAAAC,UAAAC,aAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAJ,GADjCG,EAAYL,KAAAM,KAAA,kBACJR,EAASE,KAAAM,KAAoB,gBAAAC,EAAAF,EAAAC,KAAA,WAI1BE,EAAoBC,EAAOC,OAAO,WAEtC,SAASC,IALLN,OAAAA,EAAYO,MAAKN,IAArBG,EAAAN,OAAA,EAGA,SAAIK,EAAAA,EAAoBC,EAAOC,EAAOG,EAAtCC,GAOI,MALJ,iBAAqBC,EAAA,sBACGP,EAAsBC,MAAON,EAAjD,WAAA,KACHW,EAAA,wDAAAA,EAAA,IAAA,IAOgB,IALRE,EACL,YAgDAC,SAAAA,EAAaR,GAChBJ,EAAAa,YAAA,UAXGT,EAAOS,YAAY,UAavBX,EAAoBF,EAAAc,GAAAP,GAChBK,EAAoBL,EAAMJ,GAAAA,GAC7BD,EAAAa,SAAA,UAXGZ,EAAkBY,SAAS,UA/B3BX,WACAA,EAAIY,KAAAA,eAAJC,SACA,IAAIC,GAAc,EACfd,GAAaD,EACZ,IAAAa,EAAAA,MAAAA,KACHA,GAAA,GAEGE,MAActB,EAAduB,qBACHD,GAAA,GAcDf,EAAkBF,OACrB,iDAEQW,EAAaL,QAAO,YAAA,WAAAS,EAAA,0BAAApB,EAAAwB,aAAA,SAAA,KACfP,EAAYP,IAAtBe,QAAA,UAAAA,QAAA,QAAA,OAAAH,EAAA,2BAEA,SAAiBlB,EAAAsB,KAAjB,aAAA1B,EAAA2B,KACApB,EAAoBC,QAAUG,QAA9B,QAAA,EAAA,yCAAAX,EAAA4B,aAAA,IAEArB,gBAGHA,EAAAF,KAAA,2BAAAQ,UAWGgB,GAGH,SAAAC,IAXGd,EAAaR,EAAOG,MAAMJ,GAAqB,GAenD,SAAGP,IACCgB,EAAOe,EAAS/B,MAAhBO,GAAA,GAGH,SAAMyB,IACH,IAAAC,EAAQ1B,EAASF,KAAA,QAEb,OADA6B,YAAK7B,GACLV,EAAGK,KAAAA,CAAO8B,OAAM,OAAAK,aAAA,EAAAT,KAAAU,cAAAH,KAGZD,IAAAA,EAAAA,CAAAA,KAAAA,EAASK,SAAAA,EAAKL,OAAAA,GAENM,OAAAA,KAAAA,EACHP,EAFD/B,MAGI8B,EAAAA,UAAAA,GACHd,EAAAhB,IAEDD,KAAAwC,GAAA,QAAA,sBAAA,WACAC,EAAAA,KAAAA,uBAAiBjC,QAAAA,gDACpBP,EATD8B,KAUH9B,EAAA8B,KAAAvB,GAVGyB,IAASK,KAAK,WAatBrC,EAAiBuB,oBAA2Bb,IAC9B4B,OAAAG,SAAAzC,EAAVuB,mBAEWmB,MAEPA,KAAAA,SAAAA,GACH5C,EAAAO,KAAA,mBAAAgB,SANLmB,iBAAAjC,EAAAF,KAAA,QAAAsC,EAAAC,kBAYK7C,KAFDwC,GAAA,QAEO,0BAAA,WACHT,EAAAA,KAAAA,2BAAAA,QAAAA,gDACH9B,EAAA0C,SALL1C,EAAA0C,SAAAnC,GAQHmC,MARG3C,KAAKwC,GAAG,QAAS,sBAAuB,WACjCvC,EAAOuB,oBAAsBb,IAC5B4B,OAAOG,SAAWzC,EAAOuB,mBAEzBO,MAGRd,EAAa,IAEVjB,OApHd,CAsHC8C","file":"wizard.js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2018, Shuup Inc. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    $.fn.wizard = function(config={}) {\n        let $navItems = this.find(\".wizard-nav li\");\n        let $panes = this.find(\".wizard-pane\");\n        let $activeNavItem = $navItems.find(\".active\");\n        let $activeWizardPane = $panes.filter(\".active\");\n\n        function isLastPane(){\n            return $panes.index($activeWizardPane) == $panes.length - 1;\n        }\n\n        function getButton(text, name, disable, classes, tooltip) {\n            return (\n                '<button name=\"' + name + '\"' +\n                         'class=\"btn btn-lg ' + classes + '\" ' + (disable? \"disabled\":\"\") +\n                         (tooltip? \"data-toggle='tooltip' data-placement='bottom' title='\" + tooltip + \"'\": \"\") +\n                         '>' +\n                    text +\n                '</button>'\n            );\n        }\n\n        function addActionBarToActivePane() {\n            $panes.find(\".action-bar\").remove();\n            let disablePrevious = false;\n            let disableNext = false;\n            if($panes.index($activeWizardPane) === 0) {\n                disablePrevious = true;\n            }\n            if(isLastPane() && !config.redirectOnLastPane) {\n                disableNext = true;\n            }\n\n            $activeWizardPane.append(\n                '<div class=\"action-bar\">' +\n                    '<div class=\"clearfix\">' +\n                        getButton(gettext(\"Previous\"), \"previous\", disablePrevious, \"btn-primary pull-left \" + (config.hidePrevious? \"hidden\":\"\")) +\n                        getButton(isLastPane() ? gettext(\"Finish\") : gettext(\"Next\"), \"next\", disableNext, \"btn-primary pull-right\") +\n                        (\n                            ($activeWizardPane.data(\"can_skip\") === \"True\" || config.skip) ?\n                            getButton(gettext(\"Skip\"), \"skip\", false, \"btn-default pull-right btn-wizard-skip\", config.skipTooltip) : ''\n                        ) +\n                    '</div>' +\n                '</div>'\n            );\n            $activeWizardPane.find('[data-toggle=\"tooltip\"]').tooltip();\n        }\n\n        function switchToPane(index) {\n            $navItems.removeClass(\"active\");\n            $panes.removeClass(\"active\");\n            $activeNavItem = $navItems.eq(index);\n            $activeWizardPane = $panes.eq(index);\n            $activeNavItem.addClass(\"active\");\n            $activeWizardPane.addClass(\"active\");\n\n            addActionBarToActivePane();\n        }\n\n        function next() {\n            switchToPane($panes.index($activeWizardPane) + 1);\n        }\n\n        function previous() {\n            switchToPane($panes.index($activeWizardPane) - 1);\n        }\n\n        function submit() {\n            let $form = $activeWizardPane.find(\"form\");\n            clearErrors($form);\n            return $.ajax({method: \"POST\", traditional: true, data: serializeForm($form)});\n        }\n\n        var pubFuncs = {next, previous, submit};\n\n        if(config in pubFuncs){\n            return pubFuncs[config]();\n        } else if($.isNumeric(config)){\n            switchToPane(config);\n        } else {\n            this.on(\"click\", \"button[name='next']\", () => {\n                this.find(\"button[name='next']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.next) {\n                    config.next($activeWizardPane);\n                } else {\n                    submit().done(() => {\n                        if(config.redirectOnLastPane && isLastPane()){\n                            window.location = config.redirectOnLastPane;\n                        } else {\n                            next();\n                        }\n                    }).fail((err) => {\n                        this.find(\"i.fa.fa-spinner\").remove();\n                        renderFormErrors($activeWizardPane.find(\"form\"), err.responseJSON);\n                    });\n                }\n            });\n\n            this.on(\"click\", \"button[name='previous']\", () => {\n                this.find(\"button[name='previous']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.previous) {\n                    config.previous($activeWizardPane);\n                } else {\n                    previous();\n                }\n            });\n\n            this.on(\"click\", \"button[name='skip']\", () => {\n                if(config.redirectOnLastPane && isLastPane()){\n                    window.location = config.redirectOnLastPane;\n                } else {\n                    next();\n                }\n            });\n            switchToPane(0);\n        }\n        return this;\n    };\n}(jQuery));\n"]}