dist: xenial
sudo: false
language: python

python:
- 2.7
- 3.6
- &latest_py3 3.7

jobs:
  fast_finish: true
  include:
  - stage: deploy
    if: tag IS present
    python: *latest_py3
    install: skip
    script: skip
    deploy:
      provider: pypi
      on:
        tags: true
        all_branches: true
      user: jaraco
      password:
        secure: sUz4devei7R7jOYo8pDOUT83jyeLeb1nkZNSVmrN/UdD/n182qFoLsigLOKWsx8qhndxQejHhVLNq6NAC3RyofDJVDom0YstGBXh0H+eiFTlgQmPf/asYNBor/kGjJngy7L69/qJfApj/HKcXffCeIfWIksfTz69SQmlVpEwcX7618oj6QJvDHRT6ovALxlFUnQJe6J0v3NgEDSzNzFB3fxlBxZ5uOK1+1zrt2pT28L2sEKKV2OobaKvx1QLYiLhHQ9QqfiFUPFq5wamOg6dSPn85/M0aq82L3xdqE8P1yuUo1PrC56o6Dqyd/h0Ha3qv6szttSMyrunRJqpAWopotdeAt3apiSZNTVtxChWDxcZmxy6ODuFQMGUeDaMfR/d6eeBUY11wdtFk4UhA9w85H21q4k9OHhbi3XDnmIhib64JuT9DtTlW/kyVWToOkteAqnCKZ4x6+l27b76yWO5EN1RHJBAM+ZTwlPOH0O2ZHTPyHFdsfOOAFOtdSq/DM9gg0i1KGJHwBRykAOjpcMcUqpgXDkJJdRWTwNinkSGPHfIEDufNYkjepN6XlaaeAYTUJ1zRiSdhXnVp1aI6P41N25lSHKUa4T2rrGQJAhYDfRa1hNwX/T6dZOyhXgHOdVgqNxrmOjG3U5IY7TTvB5ck9zJD8Zu5BI+UB42XSWw1hs=
      distributions: dists
      skip_cleanup: true

cache: pip

install:
- pip install tox tox-venv

before_script:
  # Disable IPv6. Ref travis-ci/travis-ci#8361
  - if [ "${TRAVIS_OS_NAME}" == "linux" ]; then
      sudo sh -c 'echo 0 > /proc/sys/net/ipv6/conf/all/disable_ipv6';
    fi
script: tox
