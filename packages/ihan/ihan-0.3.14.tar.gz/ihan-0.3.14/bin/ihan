#!/usr/bin/env python
import click

from ihan import feed_file


@click.command()
@click.argument('filename')
@click.option('--from-beginning', default=False, type=bool)
@click.option('--batch-size', default=10, type=int)
@click.option('--endpoint', default='https://feed.ihan.ee/feed', type=str)
@click.option('--sleep-interval', default=10, type=int)
def live(filename, from_beginning, batch_size, endpoint, sleep_interval):
    feed_file(filename, from_beginning, batch_size, endpoint, sleep_interval)


@click.command()
@click.argument('filename')
@click.option('--batch-size', default=1000, type=int)
@click.option('--endpoint', default='https://feed.ihan.ee/feed', type=str)
def backfill(filename, batch_size, endpoint):
    from_beginning = True
    sleep_interval = 0
    feed_file(filename, from_beginning, batch_size, endpoint, sleep_interval)


@click.group()
def cli():
    pass


cli.add_command(live)
cli.add_command(backfill)


if __name__ == '__main__':
    cli()
