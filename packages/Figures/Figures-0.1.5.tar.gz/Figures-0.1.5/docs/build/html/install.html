
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Installing Figures &#8212; Figures  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Figures on Devstack" href="devstack.html" />
    <link rel="prev" title="Welcome to Figures’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="installing-figures">
<span id="install"></span><h1>Installing Figures<a class="headerlink" href="#installing-figures" title="Permalink to this headline">¶</a></h1>
<p>This document describes how to install and configure Figures to run in Open edX.</p>
<p>Please note that we’re currently focused on developing and troubleshooting Figures, and <em>not</em> general Open edX/devstack issues.</p>
<p>If you encounter any issues with installing or running Figures, please first ensure that your installation is working correctly and that the problem is with Figures.</p>
<ul class="simple">
<li><a class="reference external" href="https://edx.readthedocs.io/projects/edx-installing-configuring-and-running/en/latest/">Open edX installation instructions</a></li>
</ul>
<p>If you run into issues installing Open edX and cannot find an answer in the above Open edX installation instructions, you can post your issue in Open edX slack #general or #ops channels.</p>
<p>Once you know that you’ve got your base Open edX environment working and you are certain the issue with with Figures, please file an issue in <a class="reference external" href="https://github.com/appsembler/figures/issues">Figures github issues</a>.</p>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Python (2.7)</li>
<li>Django (1.8)</li>
<li>Open edX (Ginkgo)</li>
</ul>
<p>Currently, Figures runs on Open edX Ginkgo. A backport to Ficus is in progress and we’ll support Hawthorn soon.</p>
</div>
<div class="section" id="devstack">
<h2>Devstack<a class="headerlink" href="#devstack" title="Permalink to this headline">¶</a></h2>
<p>Please see the <a class="reference internal" href="devstack.html#devstack"><span class="std std-ref">devstack</span></a> documentation for instructions on how to install and configure Figures for devstack.</p>
</div>
<div class="section" id="production-cloud-server">
<h2>Production (cloud server)<a class="headerlink" href="#production-cloud-server" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to install Figures on Open edX “Ginkgo”. This is the <cite>open-release/ginkgo.master</cite> branch of edX’s <a class="reference external" href="https://github.com/edx/edx-platform/tree/open-release/ginkgo.master">edx-platform</a> LMS.</p>
<p>This can be a production server, staging, or close based development server. For purposes of the instructions here, we will assume the target is a production environment.</p>
<div class="section" id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p>We’re going to describe <em>what</em> needs to happen to get Figures installed, along with instructions on how to perform each step manually.</p>
<p>These steps are required to install and configures Figures:</p>
<ul class="simple">
<li>Add Figures to the edxapp Python packages</li>
<li>Add Figures to the installed apps in the LMS settings</li>
<li>Add Figures to the LMS settings</li>
<li>Add Figures to the LMS URL patterns</li>
<li>Run migrations to include Figures models</li>
<li>Restart the LMS</li>
</ul>
<p><strong>You will need shell access and ability to sudo as the edxapp user for the Open edX instance on which you are installing Figures.</strong></p>
<p><em>At this time, the CMS settings do not need to be modified.</em></p>
<p>The following goes into detail for each step.</p>
</div>
<div class="section" id="steps">
<h3>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h3>
<div class="section" id="add-figures-to-the-edxapp-python-packages">
<h4>Add Figures to the edxapp Python packages<a class="headerlink" href="#add-figures-to-the-edxapp-python-packages" title="Permalink to this headline">¶</a></h4>
<p>Figures needs to be added to the edxapp Python virtualenv packages.</p>
<div class="section" id="step-1">
<h5>Step 1<a class="headerlink" href="#step-1" title="Permalink to this headline">¶</a></h5>
<p>Shell to the server hosting Open edX</p>
</div>
<div class="section" id="step-2">
<h5>Step 2<a class="headerlink" href="#step-2" title="Permalink to this headline">¶</a></h5>
<p>Run <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">su</span> <span class="pre">edxapp</span> <span class="pre">-s</span> <span class="pre">/bin/bash</span></code> to switch to the edxapp user</p>
</div>
<div class="section" id="step-3">
<h5>Step 3<a class="headerlink" href="#step-3" title="Permalink to this headline">¶</a></h5>
<p>Verify you are using the <code class="docutils literal notranslate"><span class="pre">edxapp</span></code> user’s virtualenv. Run <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">pip</span></code> to check if the Python virtualenv is enabled. you should see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">edxapp</span><span class="o">/</span><span class="n">venvs</span><span class="o">/</span><span class="n">edxapp</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pip</span>
</pre></div>
</div>
<p>If you don’t, then run <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">~./edxapp_env</span></code> and check again to verify</p>
</div>
<div class="section" id="step-4">
<h5>Step 4<a class="headerlink" href="#step-4" title="Permalink to this headline">¶</a></h5>
<p>Run <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">figures</span></code> to install Figures from PyPI.</p>
<div class="section" id="alternate-steps">
<h6>Alternate Steps<a class="headerlink" href="#alternate-steps" title="Permalink to this headline">¶</a></h6>
<p>Alternately you can install Figures from source by doing the following:</p>
</div>
</div>
<div class="section" id="id1">
<h5>Step 1<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h5>
<p>Follow steps 1-3 above first</p>
</div>
<div class="section" id="id2">
<h5>Step 2<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h5>
<p>Install from Github in edit mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="n">git</span><span class="o">+</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">appsembler</span><span class="o">/</span><span class="n">figures</span><span class="o">.</span><span class="n">git</span><span class="c1">#egg=figures</span>
</pre></div>
</div>
<p>You may want to do this if you want to run from master. This is not recommended for production environments.</p>
</div>
</div>
<div class="section" id="add-figures-to-the-installed-apps-in-the-lms-settings">
<h4>Add Figures to the installed apps in the LMS settings<a class="headerlink" href="#add-figures-to-the-installed-apps-in-the-lms-settings" title="Permalink to this headline">¶</a></h4>
<p>Figures needs to be in the <code class="docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code> list in the LMS settings. For those familiar with Django, this is no different than any Django reusable app.</p>
<p>There are differnt ways to do this. Two ways are:</p>
<ul class="simple">
<li>Add Figures to the <code class="docutils literal notranslate"><span class="pre">lms.env.json</span></code> file</li>
<li>Add to the LMS settings files (in the <code class="docutils literal notranslate"><span class="pre">lms/envs/</span></code> directory)</li>
</ul>
<p>Open edX lets you add Django reusable apps via the <code class="docutils literal notranslate"><span class="pre">lms.env.json</span></code> file. This is the preferred approach as it reduces customization of <code class="docutils literal notranslate"><span class="pre">edx-platform</span></code></p>
<p>Add the following as a top level key to <code class="docutils literal notranslate"><span class="pre">/edx/app/edxapp/lms.env.json</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ADDL_INSTALLED_APPS&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">&quot;figures&quot;</span>
<span class="p">],</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">ADDL_INSTALLED_APPS</span></code> already exists, then just add <code class="docutils literal notranslate"><span class="pre">&quot;figures&quot;</span></code> to the list.</p>
<p>The other option is to add <code class="docutils literal notranslate"><span class="pre">figuress</span></code> directly to the <code class="docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code> list in the LMS settings file, <code class="docutils literal notranslate"><span class="pre">lms/envs/common.py</span></code></p>
</div>
<div class="section" id="add-figures-to-the-lms-settings">
<h4>Add Figures to the LMS settings<a class="headerlink" href="#add-figures-to-the-lms-settings" title="Permalink to this headline">¶</a></h4>
<p>Figures needs to be found by Django Webpack Loader in order to serve its UI. It also needs to be registered with the Celerybeat scheduler in order to run the ETL pipeline on a schedule.</p>
<p>Figures can do this automatically if its settings are loaded when the LMS starts up by having <code class="docutils literal notranslate"><span class="pre">figures.settings</span></code> be imported in the LMS settings.</p>
<p>At the bottom of the <code class="docutils literal notranslate"><span class="pre">lms/envs/aws.py</span></code> file, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;figures&#39;</span> <span class="ow">in</span> <span class="n">INSTALLED_APPS</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">figures</span>
    <span class="n">figures</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span>
        <span class="n">WEBPACK_LOADER</span><span class="p">,</span>
        <span class="n">CELERYBEAT_SCHEDULE</span><span class="p">,</span>
        <span class="n">ENV_TOKENS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FIGURES&#39;</span><span class="p">,</span> <span class="p">{}))</span>
</pre></div>
</div>
<p><strong>IMPORTANT</strong>: Make sure that you do the above import <em>AFTER</em> <code class="docutils literal notranslate"><span class="pre">WEBPACK_LOADER</span></code> and <code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SCHEDULE</span></code> have been declared in the LMS envs.</p>
<p>If you have implemented your own wrapper around <code class="docutils literal notranslate"><span class="pre">lms/envs/aws.py</span></code> you can add the above to that file instead. For example, Appsembler has <code class="docutils literal notranslate"><span class="pre">aws_appsembler.py</span></code> and <code class="docutils literal notranslate"><span class="pre">devstack_appsembler.py</span></code> for cloud deployments and devstack environments respectively.</p>
</div>
<div class="section" id="add-figures-to-the-lms-urlconf">
<h4>Add Figures to the LMS URLconf<a class="headerlink" href="#add-figures-to-the-lms-urlconf" title="Permalink to this headline">¶</a></h4>
<p>To access the Figures UI, the LMS needs to have its <a class="reference external" href="https://docs.djangoproject.com/en/1.8/topics/http/urls/">URLconf</a> updated to include Figures.</p>
<p>At the bottom of the <code class="docutils literal notranslate"><span class="pre">lms/urls.py</span></code> file, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;figures&#39;</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">INSTALLED_APPS</span><span class="p">:</span>
        <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^figures/&#39;</span><span class="p">,</span>
                    <span class="n">include</span><span class="p">(</span><span class="s1">&#39;figures.urls&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;figures&#39;</span><span class="p">)),</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="run-migrations-to-include-figures-models">
<h4>Run migrations to include Figures models<a class="headerlink" href="#run-migrations-to-include-figures-models" title="Permalink to this headline">¶</a></h4>
<p>Figures contains its own models which are used for storing metrics data. Because of this, you need to create database tables for Figures models.</p>
<p>As the <code class="docutils literal notranslate"><span class="pre">edxapp</span></code> user, run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">lms</span> <span class="n">migrate</span> <span class="n">figures</span>
</pre></div>
</div>
</div>
<div class="section" id="restart-the-lms">
<h4>Restart the LMS<a class="headerlink" href="#restart-the-lms" title="Permalink to this headline">¶</a></h4>
<p>Since Figures needs to add entries to the <code class="docutils literal notranslate"><span class="pre">WEBPACK_LOADER</span></code> and <code class="docutils literal notranslate"><span class="pre">CELERYBEAT_SCHEDULE</span></code> settings vars, you need to restart the LMS Django app server.</p>
<p><em>NOTE:</em> You do <strong>NOT</strong> have to restart Nginx or the host.</p>
<p>Exit the <code class="docutils literal notranslate"><span class="pre">edxapp</span></code> user to go back to the admin shell.</p>
<p>Run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">restart</span> <span class="n">edxapp</span><span class="p">:</span><span class="n">lms</span>
</pre></div>
</div>
<p>Although it shouldn’t be necessary, you can restart both the LMS and CMS by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">supervisorctl</span> <span class="n">restart</span> <span class="n">edxapp</span><span class="p">:</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="installing-figures-in-open-edx-forks">
<h2>Installing Figures in Open edX Forks<a class="headerlink" href="#installing-figures-in-open-edx-forks" title="Permalink to this headline">¶</a></h2>
<p>Please see the <a class="reference internal" href="install-appsembler.html#appsembler-install"><span class="std std-ref">Appsembler</span></a> installation instructions for instructions specific to Appsembler’s fork of edx-platform.</p>
<ul class="simple">
<li>TODO: Add instructions for community members to add instructions for their own <code class="docutils literal notranslate"><span class="pre">edx-platform</span></code> forks</li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Figures</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installing Figures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#devstack">Devstack</a></li>
<li class="toctree-l2"><a class="reference internal" href="#production-cloud-server">Production (cloud server)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-figures-in-open-edx-forks">Installing Figures in Open edX Forks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="devstack.html">Figures on Devstack</a></li>
<li class="toctree-l1"><a class="reference internal" href="install-appsembler.html">Installing Figures for Appsembler</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to Figures’s documentation!</a></li>
      <li>Next: <a href="devstack.html" title="next chapter">Figures on Devstack</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Appsembler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/install.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>