
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Figures on Devstack &#8212; Figures  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installing Figures for Appsembler" href="install-appsembler.html" />
    <link rel="prev" title="Installing Figures" href="install.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <p id="devstack"><strong>NOTICE:</strong> The contents of this doc is a cut/paste from the main repo <code class="docutils literal notranslate"><span class="pre">README</span></code> file. It needs review and update for accuracy and clarity.</p>
<div class="section" id="figures-on-devstack">
<h1>Figures on Devstack<a class="headerlink" href="#figures-on-devstack" title="Permalink to this headline">¶</a></h1>
<p>This document covers installing and running Figures in <strong>Ginkgo</strong> devstack.</p>
<p>We use the label <code class="docutils literal notranslate"><span class="pre">&lt;project&gt;</span></code> as a placeholder for your local devstack project folder. This is the folder that contains the <a class="reference external" href="https://github.com/edx/configuration/blob/open-release/ginkgo.master/vagrant/release/devstack/Vagrantfile">Vagrantfile</a> for the project to which you are installing and running Figures.</p>
<div class="section" id="installing-figures-in-devstack">
<h2>Installing Figures in Devstack<a class="headerlink" href="#installing-figures-in-devstack" title="Permalink to this headline">¶</a></h2>
<p>This section describes installing Figures in the Open edX “Ginkgo” release Devstack Vagrant environment. This is the <code class="docutils literal notranslate"><span class="pre">open-release/ginkgo.master</span></code> branch of edX’s <a class="reference external" href="https://github.com/edx/edx-platform/tree/open-release/ginkgo.master">edx-platform</a> LMS.</p>
<p>To run the Figures front-end in Devstack, you will need to run a Webpack development server on port 3000 to serve the frontend assets. This is in addition to running the LMS. You do not need to run the CMS to run Figures in Devstack.</p>
<p>Figures uses <a class="reference external" href="https://github.com/owais/django-webpack-loader">Django Webpack Loader</a> to serve the React app from the LMS. You can learn more about how this works by reading the Django Webpack Loader README.</p>
<p><strong>NOTE</strong> The following instructions assume that you are setting up devstack for active figures development.</p>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>These instructions expect that you have a running Ginkgo Vagrant based devstack and that you are working from a command line shell.</p>
</div>
<div class="section" id="steps">
<h3>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Update the Vagrantfile</li>
</ol>
<p>You need to update the Vagrantfile to provide access to port 3000 from the VM to the host (your local system)</p>
<p>Edit your <code class="docutils literal notranslate"><span class="pre">&lt;project&gt;/Vagrantfile</span></code></p>
<p>Add the following line to the conditional block <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">not</span> <span class="pre">ENV['VAGRANT_NO_PORTS']</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">3000</span>  <span class="c1"># Figures webpack server</span>
</pre></div>
</div>
<p>After updating, this section should look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># If you want to run the box but don&#39;t need network ports, set VAGRANT_NO_PORTS=1.</span>
<span class="c1"># This is useful if you want to run more than one box at once.</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">ENV</span><span class="p">[</span><span class="s1">&#39;VAGRANT_NO_PORTS&#39;</span><span class="p">]</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8000</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8000</span>  <span class="c1"># LMS</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8001</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8001</span>  <span class="c1"># Studio</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8002</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8002</span>  <span class="c1"># Ecommerce</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8003</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8003</span>  <span class="c1"># LMS for Bok Choy</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8031</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8031</span>  <span class="c1"># Studio for Bok Choy</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8120</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8120</span>  <span class="c1"># edX Notes Service</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8765</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8765</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">9200</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">9200</span>  <span class="c1"># Elasticsearch</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">18080</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">18080</span>  <span class="c1"># Forums</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8100</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8100</span>  <span class="c1"># Analytics Data API</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8110</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8110</span>  <span class="c1"># Insights</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">9876</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">9876</span>  <span class="c1"># ORA2 Karma tests</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">50070</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">50070</span>  <span class="c1"># HDFS Admin UI</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">8088</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">8088</span>  <span class="c1"># Hadoop Resource Manager</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">18381</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">18381</span>    <span class="c1"># Course discovery</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="p">:</span><span class="n">forwarded_port</span><span class="p">,</span> <span class="n">guest</span><span class="p">:</span> <span class="mi">3000</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="mi">3000</span> <span class="c1"># Figures webpack server</span>
<span class="n">end</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Clone the Figures repository</li>
</ol>
<p>On your host, go to the <code class="docutils literal notranslate"><span class="pre">&lt;project&gt;/src</span></code> folder and run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">appsembler</span><span class="o">/</span><span class="n">figures</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Install the Figures Python package</li>
</ol>
<p>From your host’s shell, ssh to the Vagrant VM:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vagrant</span> <span class="n">ssh</span>
</pre></div>
</div>
<p>Change to the <em>edxapp</em> user:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">su</span> <span class="n">edxapp</span>
</pre></div>
</div>
<p>Navigate to the Figures source directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">figures</span>
</pre></div>
</div>
<p>Install the package with pip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>Figures should now be installed. To confirm, run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">figures</span>
</pre></div>
</div>
<p>You should see a line like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Figures</span> <span class="p">(</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">figures</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Update the Devstack LMS env file</li>
</ol>
<p>Continuing as user <em>edxapp</em>, edit the <code class="docutils literal notranslate"><span class="pre">/edx/app/edxapp/lms.env.json</span></code> file.</p>
<p>As a top level key, add the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;ADDL_INSTALLED_APPS&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;figures&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>We suggest adding the above immediately after <code class="docutils literal notranslate"><span class="pre">ACTIVATION_EMAIL_SUPPORT_LINK</span></code> so that it is in alphabetical order.</p>
<ol class="arabic simple" start="5">
<li>Update your edx-platform</li>
</ol>
<p>You can update edx-platform from either the host or the VM. If you edit from the host, your edx-platform project is here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">project</span><span class="o">&gt;/</span><span class="n">edx</span><span class="o">-</span><span class="n">platform</span>
</pre></div>
</div>
<p>If you edit from within the VM, your edx-platform project is here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">edxapp</span><span class="o">/</span><span class="n">edx</span><span class="o">-</span><span class="n">platform</span>
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">lms/urls.py</span></code> to add the following to the bottom of the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;figures&#39;</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">INSTALLED_APPS</span><span class="p">:</span>
        <span class="n">urlpatterns</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^figures/&#39;</span><span class="p">,</span>
                    <span class="n">include</span><span class="p">(</span><span class="s1">&#39;figures.urls&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s1">&#39;figures&#39;</span><span class="p">)),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Edit <code class="docutils literal notranslate"><span class="pre">lms/envs/devstack.py</span></code> to add the following to the bottom of the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s1">&#39;figures&#39;</span> <span class="ow">in</span> <span class="n">INSTALLED_APPS</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">figures</span>
    <span class="n">figures</span><span class="o">.</span><span class="n">update_settings</span><span class="p">(</span>
        <span class="n">WEBPACK_LOADER</span><span class="p">,</span>
        <span class="n">CELERYBEAT_SCHEDULE</span><span class="p">,</span>
        <span class="n">ENV_TOKENS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;FIGURES&#39;</span><span class="p">,</span> <span class="p">{}))</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li>Run migrations for Figures</li>
</ol>
<p>In the Vagrant VM, as user <em>edxapp</em>, navigate to the following directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">edxapp</span><span class="o">/</span><span class="n">edx</span><span class="o">-</span><span class="n">platform</span>
</pre></div>
</div>
<p>And run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">lms</span> <span class="n">migrate</span> <span class="n">figures</span> <span class="o">--</span><span class="n">settings</span><span class="o">=&lt;</span><span class="n">environment</span> <span class="n">settings</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">environment</span> <span class="pre">settings</span></code> is <code class="docutils literal notranslate"><span class="pre">devstack</span></code> for the default named release. Individual organizations may tailor their environment settings. Appsembler uses <code class="docutils literal notranslate"><span class="pre">devstack_appsembler</span></code> for its fork:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">lms</span> <span class="n">migrate</span> <span class="n">figures</span> <span class="o">--</span><span class="n">settings</span><span class="o">=</span><span class="n">devstack_appsembler</span>
</pre></div>
</div>
<ol class="arabic simple" start="7">
<li>Install Figures front-end dependencies</li>
</ol>
<p>As the <em>edxapp</em> user, navigate to the <code class="docutils literal notranslate"><span class="pre">/edx/src/figures/frontend</span></code> directory and run the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">install</span>
</pre></div>
</div>
<p>This will install the <a class="reference external" href="https://www.npmjs.com/">NPM</a> dependencies.</p>
<p>You should now have your devstack ready to run.</p>
<div class="section" id="running-figures-in-devstack">
<h4>Running Figures in Devstack<a class="headerlink" href="#running-figures-in-devstack" title="Permalink to this headline">¶</a></h4>
<p>You will need two terminal windows open. One to start the LMS, the other to start the webpack development server for the Figures UI. In each, you should be user <em>edxapp</em>:</p>
<p>Step 1. Start the webpack development server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">figures</span><span class="o">/</span><span class="n">frontend</span>
<span class="n">npm</span> <span class="n">start</span>
</pre></div>
</div>
<p>This will start the Webpack development server on port 3000.</p>
<p>Step 2. Start the LMS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">edx</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">edxapp</span><span class="o">/</span><span class="n">edx</span><span class="o">-</span><span class="n">platform</span>

<span class="n">paver</span> <span class="n">devstack</span> <span class="n">lms</span>
</pre></div>
</div>
<p>Step 3. Open the LMS in a browser on your host</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>Go to <code class="docutils literal notranslate"><span class="pre">localhost:8000</span></code> and log in as a staff or admin user</li>
<li>navigate to <code class="docutils literal notranslate"><span class="pre">localhost:8000/figures/</span></code></li>
</ol>
</div></blockquote>
<p>The Figures main page should now be displayed.</p>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Figures</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing Figures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Figures on Devstack</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-figures-in-devstack">Installing Figures in Devstack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install-appsembler.html">Installing Figures for Appsembler</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="install.html" title="previous chapter">Installing Figures</a></li>
      <li>Next: <a href="install-appsembler.html" title="next chapter">Installing Figures for Appsembler</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Appsembler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/devstack.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>