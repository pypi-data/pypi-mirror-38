

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aws_encryption_sdk.internal.crypto.iv &mdash; aws-encryption-sdk-python 1.3.7 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="aws_encryption_sdk.internal.crypto.wrapping_keys" href="aws_encryption_sdk.internal.crypto.wrapping_keys.html" />
    <link rel="prev" title="aws_encryption_sdk.internal.crypto.encryption" href="aws_encryption_sdk.internal.crypto.encryption.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> aws-encryption-sdk-python
          

          
          </a>

          
            
            
              <div class="version">
                1.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.html">aws_encryption_sdk</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.exceptions.html">aws_encryption_sdk.exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.identifiers.html">aws_encryption_sdk.identifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.caches.html">aws_encryption_sdk.caches</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.caches.base.html">aws_encryption_sdk.caches.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.caches.local.html">aws_encryption_sdk.caches.local</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.caches.null.html">aws_encryption_sdk.caches.null</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.key_providers.base.html">aws_encryption_sdk.key_providers.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.key_providers.kms.html">aws_encryption_sdk.key_providers.kms</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.key_providers.raw.html">aws_encryption_sdk.key_providers.raw</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.materials_managers.html">aws_encryption_sdk.materials_managers</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.materials_managers.base.html">aws_encryption_sdk.materials_managers.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.materials_managers.caching.html">aws_encryption_sdk.materials_managers.caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.materials_managers.default.html">aws_encryption_sdk.materials_managers.default</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.streaming_client.html">aws_encryption_sdk.streaming_client</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.structures.html">aws_encryption_sdk.structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.html">aws_encryption_sdk.internal</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.crypto.authentication.html">aws_encryption_sdk.internal.crypto.authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.crypto.data_keys.html">aws_encryption_sdk.internal.crypto.data_keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.crypto.elliptic_curve.html">aws_encryption_sdk.internal.crypto.elliptic_curve</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.crypto.encryption.html">aws_encryption_sdk.internal.crypto.encryption</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">aws_encryption_sdk.internal.crypto.iv</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.crypto.wrapping_keys.html">aws_encryption_sdk.internal.crypto.wrapping_keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.defaults.html">aws_encryption_sdk.internal.defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.formatting.html">aws_encryption_sdk.internal.formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.formatting.deserialize.html">aws_encryption_sdk.internal.formatting.deserialize</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.formatting.encryption_context.html">aws_encryption_sdk.internal.formatting.encryption_context</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.formatting.serialize.html">aws_encryption_sdk.internal.formatting.serialize</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.str_ops.html">aws_encryption_sdk.internal.str_ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.structures.html">aws_encryption_sdk.internal.structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="aws_encryption_sdk.internal.utils.html">aws_encryption_sdk.internal.utils</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">aws-encryption-sdk-python</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>aws_encryption_sdk.internal.crypto.iv</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/generated/aws_encryption_sdk.internal.crypto.iv.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-aws_encryption_sdk.internal.crypto.iv">
<span id="aws-encryption-sdk-internal-crypto-iv"></span><h1>aws_encryption_sdk.internal.crypto.iv<a class="headerlink" href="#module-aws_encryption_sdk.internal.crypto.iv" title="Permalink to this headline">¶</a></h1>
<p>Helper functions used for generating deterministic initialization vectors (IVs).</p>
<p>Deterministic IVs are used to reduce the probability of IV/message-key pair collisions when caching
data keys.</p>
<p>Prior to introducing caching, a statement could safely be made that every encrypt call resulted in a new
data key which would only be used with a single message. With the introduction of caching, this statement
by definition becomes false.</p>
<p>This is a problem because there are cryptographic limits on the number of times AES can be safely invoked
using the same key (or using keys derived from the same key) and a random IV. In framed messages, this
manifests as the total number of frames which can be safely encrypted under the same data key across all
messages for which the data key is reused.</p>
<p>By using a random IV for each frame, we actually decrease the number of frames which can be safely encrypted
under the same data key.  Rather than attempting to track the number of frames across messages, we decided
to move to a deterministic IV constructed in such a way that it is guaranteed to never conflict within the
same message.  This means that we can consider only the likelihood of KDF collisions, which raises the limit
sufficiently that we can assume that every message contains the maximum 2^32 invocations (2^32 - 1 frames +
header auth).</p>
<p>Each IV is constructed from two big-endian byte arrays concatenated in the following order:</p>
<ol class="arabic simple">
<li><strong>64 bytes</strong> : 0 (reserved space for possible future use)</li>
<li><strong>32 bytes</strong> : frame sequence number (0 for the header auth calculation)</li>
</ol>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#aws_encryption_sdk.internal.crypto.iv.frame_iv" title="aws_encryption_sdk.internal.crypto.iv.frame_iv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">frame_iv</span></code></a>(algorithm,&nbsp;sequence_number)</td>
<td>Builds the deterministic IV for a body frame.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#aws_encryption_sdk.internal.crypto.iv.header_auth_iv" title="aws_encryption_sdk.internal.crypto.iv.header_auth_iv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">header_auth_iv</span></code></a>(algorithm)</td>
<td>Builds the deterministic IV for header authentication.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#aws_encryption_sdk.internal.crypto.iv.non_framed_body_iv" title="aws_encryption_sdk.internal.crypto.iv.non_framed_body_iv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">non_framed_body_iv</span></code></a>(algorithm)</td>
<td>Builds the deterministic IV for a non-framed body.</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="aws_encryption_sdk.internal.crypto.iv.frame_iv">
<code class="descclassname">aws_encryption_sdk.internal.crypto.iv.</code><code class="descname">frame_iv</code><span class="sig-paren">(</span><em>algorithm</em>, <em>sequence_number</em><span class="sig-paren">)</span><a class="headerlink" href="#aws_encryption_sdk.internal.crypto.iv.frame_iv" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the deterministic IV for a body frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>algorithm</strong> (<em>aws_encryption_sdk.identifiers.Algorithm</em>) – Algorithm for which to build IV</li>
<li><strong>sequence_number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Frame sequence number</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Generated IV</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)">bytes</a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><a class="reference internal" href="aws_encryption_sdk.exceptions.html#aws_encryption_sdk.exceptions.ActionNotAllowedError" title="aws_encryption_sdk.exceptions.ActionNotAllowedError"><strong>ActionNotAllowedError</strong></a> – if sequence number of out bounds</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aws_encryption_sdk.internal.crypto.iv.non_framed_body_iv">
<code class="descclassname">aws_encryption_sdk.internal.crypto.iv.</code><code class="descname">non_framed_body_iv</code><span class="sig-paren">(</span><em>algorithm</em><span class="sig-paren">)</span><a class="headerlink" href="#aws_encryption_sdk.internal.crypto.iv.non_framed_body_iv" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the deterministic IV for a non-framed body.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>algorithm</strong> (<em>aws_encryption_sdk.identifiers.Algorithm</em>) – Algorithm for which to build IV</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Generated IV</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)">bytes</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aws_encryption_sdk.internal.crypto.iv.header_auth_iv">
<code class="descclassname">aws_encryption_sdk.internal.crypto.iv.</code><code class="descname">header_auth_iv</code><span class="sig-paren">(</span><em>algorithm</em><span class="sig-paren">)</span><a class="headerlink" href="#aws_encryption_sdk.internal.crypto.iv.header_auth_iv" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds the deterministic IV for header authentication.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>algorithm</strong> (<em>aws_encryption_sdk.identifiers.Algorithm</em>) – Algorithm for which to build IV</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Generated IV</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.7)">bytes</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aws_encryption_sdk.internal.crypto.wrapping_keys.html" class="btn btn-neutral float-right" title="aws_encryption_sdk.internal.crypto.wrapping_keys" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aws_encryption_sdk.internal.crypto.encryption.html" class="btn btn-neutral" title="aws_encryption_sdk.internal.crypto.encryption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Amazon

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>